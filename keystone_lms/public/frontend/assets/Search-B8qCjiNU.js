import{d as R,x as T,y as $,da as N,c as j,L as x,A as z,a as r,b as n,e as u,u as c,w as v,at as H,b$ as J,t as d,f as h,F as b,r as V,B as f,q as Y,o as i,aq as E,cG as F,n as P,ab as A,_ as I,i as K,aF as O}from"./index-H4DTv6Le.js";import{_ as G}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";const U={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},X={class:"w-4/6 mx-auto py-5"},W={class:"px-2.5"},Z={class:"flex items-center"},Q={key:0,class:"text-sm text-ink-gray-5 mt-2"},ee={key:1,class:"text-sm text-ink-gray-5 mt-2"},ae={key:2,class:"text-sm text-ink-gray-5 mt-2"},te={class:"mt-5"},se={key:0,class:""},ne=["onClick"],oe={class:"space-y-1 w-full"},re={class:"flex items-center"},ie=["innerHTML"],ce={class:"text-sm text-ink-gray-5 ml-2"},le={key:0,class:"ml-auto text-sm text-ink-gray-5"},ue=["innerHTML"],fe=R({__name:"Search",setup(de){const t=f(""),k=f(null),s=f([]),{brand:q}=T(),l=Y(),S=O(),_=f(!1),M=K("$dayjs");$(()=>{l.currentRoute.value.query.q&&(t.value=l.currentRoute.value.query.q,p())});const y=e=>{t.value=e,l.replace({query:e?{q:e}:{}})},p=N(()=>{t.value.length>2&&m.reload()},500),m=j({url:"lms.command_palette.search_sqlite",makeParams:()=>({query:t.value}),onSuccess(){w()}}),w=()=>{s.value=[],m.data&&(_.value=!1,m.data.forEach(e=>{e.items.forEach(o=>{s.value.push(o)})}),C())},C=()=>{s.value.sort((e,o)=>{const a=new Date(e.published_on||e.start_date||e.creation||e.modified).getTime();return new Date(o.published_on||o.start_date||o.creation||o.modified).getTime()-a})},B=e=>{e.doctype=="LMS Course"?l.push({name:"CourseDetail",params:{courseName:e.name}}):e.doctype=="LMS Batch"?l.push({name:"BatchDetail",params:{batchName:e.name}}):e.doctype=="Job Opportunity"&&l.push({name:"JobDetail",params:{job:e.name}})};x(t,()=>{var e;t.value&&t.value!=((e=m.params)==null?void 0:e.query)?_.value=!0:t.value||(_.value=!1,s.value=[])}),x(()=>S.query.q,e=>{e&&e!==t.value&&(t.value=e,p())});const L=e=>e==="LMS Course"?__("Course"):e==="LMS Batch"?__("Batch"):e==="Job Opportunity"?__("Job"):e,D=()=>{t.value="",y("")};return z(()=>({title:__("Search"),icon:q.favicon})),(e,o)=>(i(),r(b,null,[n("header",U,[u(c(G),{items:[{label:e.__("Search")}]},null,8,["items"])]),n("div",X,[n("div",W,[u(c(J),{ref_key:"searchInput",ref:k,class:"flex-1",placeholder:"Search for a keyword or phrase and press enter",autocomplete:"off","model-value":t.value,"onUpdate:modelValue":y,onKeydown:o[0]||(o[0]=H(()=>c(p)(),["enter"]))},{prefix:v(()=>[u(c(F),{class:"w-4 text-ink-gray-5"})]),suffix:v(()=>[n("div",Z,[t.value?(i(),r("button",{key:0,onClick:D,class:"p-1 size-6 grid place-content-center focus:outline-none focus:ring focus:ring-outline-gray-3 rounded"},[u(c(E),{class:"w-4 text-ink-gray-7"})])):h("",!0)])]),_:1},8,["model-value"]),t.value&&s.value.length?(i(),r("div",Q,d(s.value.length)+" "+d(s.value.length===1?e.__("match"):e.__("matches")),1)):_.value?(i(),r("div",ee,d(e.__("Press enter to search")),1)):t.value&&!s.value.length?(i(),r("div",ae,d(e.__("No results found")),1)):h("",!0)]),n("div",te,[s.value.length?(i(),r("div",se,[(i(!0),r(b,null,V(s.value,(a,g)=>(i(),r("div",{onClick:_e=>B(a),class:"rounded-md cursor-pointer hover:bg-surface-gray-2 px-2"},[n("div",{class:P(["flex space-x-2 py-3",{"border-b":g!==s.value.length-1}])},[u(c(I),{text:a.author_info.full_name},{default:v(()=>[u(c(A),{label:a.author_info.full_name,image:a.author_info.user_image,size:"md"},null,8,["label","image"])]),_:2},1032,["text"]),n("div",oe,[n("div",re,[n("div",{class:"font-medium text-ink-gray-9",innerHTML:a.title},null,8,ie),n("div",ce,d(L(a.doctype)),1),a.published_on||a.start_date||a.creation||a.modified?(i(),r("div",le,d(c(M)(a.published_on||a.start_date||a.creation||a.modified).format("DD MMM YYYY")),1)):h("",!0)]),n("div",{class:"leading-5 text-ink-gray-7",innerHTML:a.content},null,8,ue)])],2)],8,ne))),256))])):h("",!0)])])],64))}});export{fe as default};
//# sourceMappingURL=Search-B8qCjiNU.js.map
