import{x as K,H as O,y as W,L as G,W as J,A as X,o as n,a as u,b as p,e as i,u as e,l as y,w as l,k as N,t as k,P as Y,p as w,f as S,bx as b,N as x,F as $,r as F,ag as Z,af as ee,ah as ae,ai as te,ak as se,bp as ie,al as le,at as oe,D as ne,i as j,q as re,B as z,aF as ue,E as B,g as de,T as V,aw as ce}from"./index-H4DTv6Le.js";import{_ as _e}from"./EmptyState.vue_vue_type_script_setup_true_lang-C4EPuQXe.js";import{_ as me}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";const fe={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},pe={class:"py-5 mx-5"},ye={class:"flex items-center justify-between mb-4"},ke={class:"text-lg font-semibold text-ink-gray-7"},ve={key:0},ge={key:1,class:"text-xs text-ink-gray-5"},he={key:2},ze={class:"flex gap-2"},we={key:2,class:"flex justify-center my-5"},Qe={__name:"Quizzes",setup(be){var M;const{brand:L}=K(),{capture:P}=O(),_=j("$user"),D=j("$dayjs"),Q=re(),E=ue(),v=z(""),U=window.read_only_mode,g=z({}),m=z(!1),d=z("");W(()=>{var s,a,c,f;!((s=_.data)!=null&&s.is_moderator)&&!((a=_.data)!=null&&a.is_instructor)?Q.push({name:"Courses"}):(c=_.data)!=null&&c.is_moderator||(g.value.owner=(f=_.data)==null?void 0:f.name),E.query.new==="true"&&(m.value=!0)}),G(v,()=>{g.value.title=["like",`%${v.value}%`],r.update({filters:g.value}),r.reload()});const r=J({doctype:"LMS Quiz",filters:g,fields:["name","title","passing_percentage","total_marks","show_answers","max_attempts","modified"],auto:!0,cache:["quizzes",(M=_.data)==null?void 0:M.name],orderBy:"modified desc",transform(s){return s.map(a=>({...a,modified:D(a.modified).fromNow()}))}}),A=()=>{d.value=ce(d.value.trim())},C=s=>{A(),r.insert.submit({title:d.value},{onSuccess(a){V.success(__("Quiz created successfully")),s(),d.value="",P("quiz_created"),Q.push({name:"QuizForm",params:{quizID:a.name}})},onError(a){V.error(__("Error creating quiz: {0}",a.message))}})},R=(s,a)=>{Array.from(s).forEach(async c=>{await r.delete.submit(c)}),a(),V.success(__("Quizzes deleted successfully"))},q=B(()=>[{label:__("Title"),key:"title",width:2,icon:"file-text"},{label:__("Total Marks"),key:"total_marks",width:1,align:"center",icon:"hash"},{label:__("Passing Percentage"),key:"passing_percentage",width:1,align:"center",icon:"percent"},{label:__("Max Attempts"),key:"max_attempts",width:1,align:"center",icon:"repeat"},{label:__("Show Answers"),key:"show_answers",width:1,align:"center",icon:"eye"},{label:__("Modified"),key:"modified",width:1,align:"center",icon:"clock"}]),H=B(()=>[{label:__("Quizzes"),route:{name:"Quizzes"}}]);return X(()=>({title:__("Quizzes"),icon:L.favicon})),(s,a)=>{var f,T;const c=de("router-link");return n(),u($,null,[p("header",fe,[i(e(me),{items:H.value},null,8,["items"]),e(U)?S("",!0):(n(),y(e(w),{key:0,variant:"solid",onClick:a[0]||(a[0]=t=>m.value=!0)},{prefix:l(()=>[i(e(Y),{class:"w-4 h-4"})]),default:l(()=>[N(" "+k(s.__("Create")),1)]),_:1}))]),p("div",pe,[p("div",ye,[p("div",ke,k((f=e(r).data)!=null&&f.length?s.__("{0} Quizzes").format(e(r).data.length):s.__("No Quizzes")),1),i(e(x),{modelValue:v.value,"onUpdate:modelValue":a[1]||(a[1]=t=>v.value=t),type:"text",placeholder:"Search"},{prefix:l(()=>[i(e(b),{name:"search",class:"size-4 text-ink-gray-5"})]),_:1},8,["modelValue"])]),(T=e(r).data)!=null&&T.length?(n(),y(e(le),{key:0,columns:q.value,rows:e(r).data,"row-key":"name",options:{showTooltip:!1,selectable:!0}},{default:l(()=>[i(e(ee),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:l(()=>[(n(!0),u($,null,F(q.value,t=>(n(),y(e(Z),{item:t},{prefix:l(({item:o})=>{var h;return[i(e(b),{name:(h=o.icon)==null?void 0:h.toString(),class:"h-4 w-4"},null,8,["name"])]}),_:2},1032,["item"]))),256))]),_:1}),i(e(se),null,{default:l(()=>[(n(!0),u($,null,F(e(r).data,t=>(n(),y(c,{to:{name:"QuizForm",params:{quizID:t.name}}},{default:l(()=>[i(e(ae),{row:t},{default:l(({column:o,item:h})=>[i(e(te),{item:t[o.key],align:o.align},{default:l(()=>[o.key=="show_answers"?(n(),u("div",ve,[i(e(x),{type:"checkbox",modelValue:t[o.key],"onUpdate:modelValue":I=>t[o.key]=I,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])])):o.key=="modified"?(n(),u("div",ge,k(t[o.key]),1)):(n(),u("div",he,k(t[o.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1}),i(e(ie),null,{actions:l(({unselectAll:t,selections:o})=>[p("div",ze,[i(e(w),{variant:"ghost",onClick:h=>R(o,t)},{default:l(()=>[i(e(b),{name:"trash-2",class:"h-4 w-4 stroke-1.5"})]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])):(n(),y(_e,{key:1,type:"Quizzes"})),e(r).hasNextPage?(n(),u("div",we,[i(e(w),{onClick:a[2]||(a[2]=t=>e(r).next())},{default:l(()=>[N(k(s.__("Load More")),1)]),_:1})])):S("",!0)]),i(e(ne),{modelValue:m.value,"onUpdate:modelValue":a[5]||(a[5]=t=>m.value=t),options:{title:s.__("Create a Quiz"),size:"sm",actions:[{label:s.__("Save"),variant:"solid",onClick({close:t}){C(t)}}]}},{"body-content":l(()=>[i(e(x),{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=t=>d.value=t),label:s.__("Title"),type:"text",onKeydown:a[4]||(a[4]=oe(t=>C(()=>m.value=!1),["enter"]))},null,8,["modelValue","label"])]),_:1},8,["modelValue","options"])],64)}}};export{Qe as default};
//# sourceMappingURL=Quizzes-DXawCsRo.js.map
