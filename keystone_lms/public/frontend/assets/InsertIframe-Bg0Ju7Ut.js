import{d as P,y as B,b1 as S,o as v,a as p,aa as T,c0 as W,c1 as $,e as i,w as d,b as c,u as m,p as V,k as w,cn as H,at as j,t as R,f as z,D as G,B as s,E as b,fh as _,fi as C,fj as K,fk as M,aX as O,fl as D}from"./index-H4DTv6Le.js";const F={class:"space-y-4"},X={key:0,class:"text-red-500 text-sm mt-1"},q={key:1,class:"text-ink-green-3 text-sm mt-1"},J={class:"flex justify-end space-x-2"},Y=P({__name:"InsertIframe",props:{editor:{}},setup(E){const o=E,n=s(!1),a=s(""),l=s(""),k=s(""),y=s("center"),g=s(640),I=s(360),h=s(),r=b(()=>{if(!a.value)return!1;try{if(a.value.trim().startsWith("<iframe")){const e=a.value.match(/src=["']([^"']+)["']/);return e!=null&&e[1]?_(e[1],{allowedDomains:C,HTMLAttributes:{}}):!1}return _(a.value,{allowedDomains:C,HTMLAttributes:{}})}catch{return!1}}),f=b(()=>{if(!a.value)return"";if(a.value.trim().startsWith("<iframe")){const e=a.value.match(/src=["']([^"']+)["']/);return e!=null&&e[1]?D(e[1]):a.value}return D(a.value)}),A=b(()=>{if(!a.value||!r.value)return{platform:"Generic",aspectRatio:9/16};const e=K(f.value),t=M(f.value);return{platform:(e==null?void 0:e.name)||"Generic",aspectRatio:t.ratio}});function N(){l.value="",a.value&&(r.value||(l.value="Please enter a supported URL or iframe embed code"))}function U(){n.value=!0,a.value="",l.value="",k.value="",y.value="center",g.value=640,I.value=360,O(()=>{var e,t;(t=(e=h.value)==null?void 0:e.el)==null||t.focus()})}function x(){if(!a.value||!r.value)return;o.editor.commands.setIframe({src:f.value,width:g.value,height:I.value,title:k.value,align:y.value})?(n.value=!1,o.editor.commands.focus()):l.value="Failed to insert embed. Please check the URL and try again."}function L(e){var t;((t=e.detail)==null?void 0:t.editor)===o.editor&&U()}return B(()=>{o.editor.view.dom.addEventListener("iframe:open-dialog",L)}),S(()=>{try{o.editor.view.dom.removeEventListener("iframe:open-dialog",L)}catch{}}),(e,t)=>(v(),p("div",null,[T(e.$slots,"default",W($({onClick:U}))),i(m(G),{modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=u=>n.value=u),options:{title:"Insert Embed",size:"md"}},{"body-content":d(()=>[c("div",F,[c("div",null,[t[3]||(t[3]=c("label",{class:"block text-sm font-medium text-ink-gray-7 mb-2"}," URL or Embed Code ",-1)),i(m(H),{ref_key:"urlInput",ref:h,modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=u=>a.value=u),placeholder:"https://youtube.com/watch?v=... or <iframe src=...>",onKeydown:j(x,["enter"]),onInput:N},null,8,["modelValue"]),l.value?(v(),p("p",X,R(l.value),1)):a.value&&r.value?(v(),p("p",q," âœ“ Valid "+R(A.value.platform)+" URL ",1)):z("",!0)])])]),actions:d(()=>[c("div",J,[i(m(V),{variant:"subtle",onClick:t[1]||(t[1]=u=>n.value=!1)},{default:d(()=>[...t[4]||(t[4]=[w("Cancel",-1)])]),_:1}),i(m(V),{variant:"solid",disabled:!a.value||!r.value,onClick:x},{default:d(()=>[...t[5]||(t[5]=[w(" Insert Embed ",-1)])]),_:1},8,["disabled"])])]),_:1},8,["modelValue"])]))}});export{Y as default};
//# sourceMappingURL=InsertIframe-Bg0Ju7Ut.js.map
