{"version":3,"file":"eChartOptions-9LlNrXtG.js","sources":["../../../../frontend/node_modules/frappe-ui/src/components/Charts/eChartOptions.ts"],"sourcesContent":["import { formatDate, formatLabel, formatValue, mergeDeep } from './helpers'\nimport { AxisChartConfig } from './types'\n\nexport const PADDING_TOP = 0\nexport const PADDING_BOTTOM = 10\nexport const AXIS_TITLE_HEIGHT = 20\nexport const LEGEND_HEIGHT = 30\nexport const LEGEND_BOTTOM = 10\nexport const TITLE_HEIGHT = 20\nexport const SUBTITLE_HEIGHT = 18\nexport const TITLE_BOTTOM = 24\n\nexport default function useEchartsOptions(config: AxisChartConfig) {\n  const title = config.title\n  const subtitle = config.subtitle\n  const hasTitle = title ? 1 : 0\n  const hasSubtitle = subtitle ? 1 : 0\n  const hasXAxisTitle = config.xAxis.title ? 1 : 0\n  const hasYAxisTitle = config.yAxis.title ? 1 : 0\n  const hasY2AxisTitle = config.y2Axis?.title ? 1 : 0\n  const hasLegend = config.series.length > 1 ? 1 : 0\n\n  const xAxisOptions = getXAxisOptions(config)\n  const yAxisOptions = getYAxisOptions(config)\n\n  return {\n    animation: true,\n    animationDuration: 700,\n    textStyle: { fontFamily: ['InterVar', 'sans-serif'] },\n    title: getTitleOptions(title, subtitle),\n    color: config.colors,\n    grid: {\n      left: '1%',\n      right: config.swapXY ? '2.5%' : '1.5%',\n      top:\n        PADDING_TOP +\n        TITLE_HEIGHT * hasTitle +\n        SUBTITLE_HEIGHT * hasSubtitle +\n        TITLE_BOTTOM,\n      bottom: PADDING_BOTTOM + LEGEND_HEIGHT * hasLegend,\n      containLabel: true,\n    },\n    xAxis: xAxisOptions,\n    yAxis: yAxisOptions,\n    series: [],\n    tooltip: {\n      show: true,\n      trigger: 'axis',\n      formatter: (params: Object | Array<Object>) => {\n        if (Array.isArray(params)) {\n          params = params\n            // remove zero values\n            .filter((p) => p.value?.[1] !== 0)\n            // sort in descending order by value\n            .sort((a, b) => b.value?.[1] - a.value?.[1])\n        }\n\n        if (!Array.isArray(params)) {\n          const p = params as any\n          const value = config.swapXY ? p.value[0] : p.value[1]\n          const formatted = isNaN(value) ? value : formatValue(value)\n          return `\n                <div class=\"flex items-center justify-between gap-5\">\n                  <div>${p.name}</div>\n                  <div class=\"font-bold\">${formatted}</div>\n                </div>\n              `\n        }\n\n        if (Array.isArray(params)) {\n          const t = params.map((p, idx) => {\n            const xValue = config.swapXY ? p.value[1] : p.value[0]\n            const yValue = config.swapXY ? p.value[0] : p.value[1]\n            const formattedX =\n              config.xAxis.type == 'time'\n                ? formatDate(xValue, undefined, config.xAxis.timeGrain)\n                : xValue\n            const formattedY = isNaN(yValue) ? yValue : formatValue(yValue)\n            return `\n              <div class=\"flex flex-col\">\n                ${idx == 0 ? `<div>${formattedX}</div>` : ''}\n                <div class=\"flex items-center justify-between gap-5\">\n                  <div class=\"flex gap-1 items-center\">\n                    ${p.marker}\n                    <div>${formatLabel(p.seriesName)}:</div>\n                  </div>\n                  <div class=\"font-bold\">${formattedY}</div>\n                </div>\n              </div>\n            `\n          })\n          return t.join('')\n        }\n      },\n      confine: true,\n      appendToBody: false,\n      axisPointer: {\n        type: 'shadow',\n      },\n    },\n    legend: {\n      show: hasLegend,\n      type: 'scroll',\n      bottom: LEGEND_BOTTOM,\n      orient: 'horizontal',\n      itemGap: 12,\n      padding: [0, 25],\n      formatter: function (name: string) {\n        return formatLabel(name)\n      },\n      textStyle: {\n        padding: [0, 0, 0, -5],\n        color: 'var(--ink-gray-8)',\n      },\n      icon: 'circle',\n      pageIcons: {\n        horizontal: [\n          'M 17 3 h 2 c 0.386 0 0.738 0.223 0.904 0.572 s 0.115 0.762 -0.13 1.062 L 11.292 15 l 8.482 10.367 c 0.245 0.299 0.295 0.712 0.13 1.062 S 19.386 27 19 27 h -2 c -0.3 0 -0.584 -0.135 -0.774 -0.367 l -9 -11 c -0.301 -0.369 -0.301 -0.898 0 -1.267 l 9 -11 C 16.416 3.135 16.7 3 17 3 Z',\n          'M 12 27 h -2 c -0.386 0 -0.738 -0.223 -0.904 -0.572 s -0.115 -0.762 0.13 -1.062 L 17.708 15 L 9.226 4.633 c -0.245 -0.299 -0.295 -0.712 -0.13 -1.062 S 9.614 3 10 3 h 2 c 0.3 0 0.584 0.135 0.774 0.367 l 9 11 c 0.301 0.369 0.301 0.898 0 1.267 l -9 11 C 12.584 26.865 12.3 27 12 27 Z',\n        ],\n      },\n      pageIconColor: 'var(--ink-gray-6)',\n      pageInactiveColor: 'var(--ink-gray-4)',\n      pageIconSize: 10,\n      pageTextStyle: {\n        color: 'var(--ink-gray-6)',\n      },\n      animationDurationUpdate: 300,\n    },\n  }\n}\n\nexport function getTitleOptions(title: string, subtitle?: string) {\n  return {\n    top: '4px',\n    left: '0.8%',\n    text: title,\n    subtext: subtitle,\n    padding: 0,\n    itemGap: -3,\n    textStyle: {\n      fontSize: 14,\n      fontWeight: 500,\n      lineHeight: 24,\n      color: 'var(--ink-gray-8)',\n    },\n    subtextStyle: {\n      fontSize: 13,\n      fontWeight: 400,\n      lineHeight: 20,\n      color: 'var(--ink-gray-6)',\n    },\n  }\n}\n\nfunction getXAxisOptions(config: AxisChartConfig) {\n  const options = config.swapXY\n    ? {\n        show: true,\n        type: 'value',\n        z: 2,\n        scale: false,\n        boundaryGap: false,\n        position: 'top',\n        name: `${config.yAxis.title} →`,\n        nameGap: 6,\n        nameLocation: 'end',\n        nameTextStyle: {\n          align: 'right',\n          verticalAlign: 'bottom',\n          padding: [0, 0, 26, 0],\n          backgroundColor: 'var(--surface-white)',\n          borderColor: 'var(--surface-white)',\n          color: 'var(--ink-gray-8)',\n          borderWidth: 4,\n        },\n        splitLine: {\n          show: true,\n          width: 1,\n          lineStyle: {\n            color: 'var(--ink-gray-3)',\n          },\n        },\n        axisLine: {\n          show: false,\n          onZero: false,\n        },\n        axisTick: {\n          show: false,\n          alignWithLabel: true,\n          formatter: function (value: number) {\n            return formatValue(value, 1, true)\n          },\n        },\n        axisLabel: {\n          show: true,\n          hideOverlap: true,\n          margin: 8,\n          formatter: function (value: number) {\n            return formatValue(value, 1, true)\n          },\n        },\n      }\n    : {\n        z: 2,\n        type: config.xAxis.type,\n        scale: true,\n        splitLine: {\n          show: false,\n        },\n        axisLine: {\n          show: true,\n        },\n        axisTick: {\n          show: false,\n          alignWithLabel: true,\n        },\n        axisLabel: {\n          show: true,\n          hideOverlap: true,\n          showMaxLabel:\n            config.xAxis.type === 'category' || config.xAxis.type === 'value',\n          margin: 8,\n        },\n      }\n\n  return mergeDeep(options, config.swapXY ? config.yAxis.echartOptions : config.xAxis.echartOptions)\n}\n\nfunction getYAxisOptions(config: AxisChartConfig) {\n  let primaryYAxisOptions = config.swapXY\n    ? {\n        show: true,\n        type: config.xAxis.type,\n        z: 2,\n        scale: true,\n        inverse: 'true',\n        splitLine: {\n          show: false,\n        },\n        axisLine: {\n          show: true,\n        },\n        axisTick: {\n          show: false,\n          alignWithLabel: true,\n        },\n        axisLabel: {\n          show: true,\n          hideOverlap: true,\n          margin: 6,\n        },\n      }\n    : {\n        show: true,\n        type: 'value',\n        z: 2,\n        scale: false,\n        boundaryGap: ['0%', '1%'],\n        name: `↑ ${config.yAxis.title}`,\n        nameGap: 6,\n        nameLocation: 'end',\n        nameTextStyle: {\n          align: 'left',\n          verticalAlign: 'top',\n          padding: [0, 0, 0, -2],\n          backgroundColor: 'var(--surface-white)',\n          borderColor: 'var(--surface-white)',\n          color: 'var(--ink-gray-8)',\n          borderWidth: 4,\n        },\n        splitLine: {\n          show: true,\n          width: 1,\n          lineStyle: {\n            color: 'var(--ink-gray-3)',\n          },\n        },\n        axisLine: {\n          show: false,\n          onZero: false,\n        },\n        axisTick: {\n          show: false,\n          alignWithLabel: true,\n        },\n        axisLabel: {\n          show: true,\n          hideOverlap: true,\n          margin: 8,\n          formatter: function (value: number) {\n            return formatValue(value, 1, true)\n          },\n        },\n        min: config.yAxis.yMin,\n        max: config.yAxis.yMax,\n      }\n\n  primaryYAxisOptions = mergeDeep(\n    primaryYAxisOptions,\n    config.swapXY ? config.xAxis.echartOptions : config.yAxis.echartOptions\n  )\n\n  let secondaryYAxisOptions = {\n    show: false,\n    type: 'value',\n    z: 2,\n    alignTicks: true,\n    scale: false,\n    boundaryGap: ['0%', '1%'],\n    name: `${config.y2Axis?.title} ↑`,\n    nameLocation: 'end',\n    nameTextStyle: {\n      align: 'right',\n      verticalAlign: 'top',\n      padding: [0, 5, 0, 0],\n      backgroundColor: 'var(--surface-white)',\n      borderColor: 'var(--surface-white)',\n      color: 'var(--ink-gray-8)',\n    },\n    nameGap: 6,\n    splitLine: {\n      show: true,\n      width: 1,\n      lineStyle: {\n        color: 'var(--ink-gray-3)',\n      },\n    },\n    axisLine: {\n      show: false,\n      onZero: false,\n    },\n    axisTick: {\n      show: false,\n      alignWithLabel: true,\n    },\n    axisLabel: {\n      show: true,\n      hideOverlap: true,\n      margin: 8,\n      formatter: function (value: number) {\n        return formatValue(value, 1, true)\n      },\n      // color: '#000',\n    },\n    min: config.y2Axis?.yMin,\n    max: config.y2Axis?.yMax,\n  }\n\n  secondaryYAxisOptions = mergeDeep(\n    secondaryYAxisOptions,\n    config.swapXY ? config.y2Axis?.echartOptions : config.y2Axis?.echartOptions\n  )\n\n  return config.swapXY\n    ? [primaryYAxisOptions]\n    : [primaryYAxisOptions, secondaryYAxisOptions]\n}\n"],"names":["PADDING_TOP","PADDING_BOTTOM","LEGEND_HEIGHT","LEGEND_BOTTOM","TITLE_HEIGHT","SUBTITLE_HEIGHT","TITLE_BOTTOM","useEchartsOptions","config","title","subtitle","hasTitle","hasSubtitle","_a","hasLegend","xAxisOptions","getXAxisOptions","yAxisOptions","getYAxisOptions","getTitleOptions","params","p","a","b","_b","value","formatted","formatValue","idx","xValue","yValue","formattedX","formatDate","formattedY","formatLabel","name","options","mergeDeep","primaryYAxisOptions","secondaryYAxisOptions","_c","_d","_e"],"mappings":"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","x_google_ignoreList":[0]}