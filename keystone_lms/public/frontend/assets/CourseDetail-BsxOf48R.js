import{q as me,i as ne,H as De,c as Y,g as _e,o as l,a as c,f as y,b as t,t as d,u as e,e as r,w as f,p as B,a0 as fe,l as M,a1 as qe,k as j,a2 as te,G as de,n as ae,a3 as Te,a4 as xe,a5 as we,a6 as ie,E as K,T as F,z as Ce,s as Q,N as E,D as pe,v as ve,a7 as Ve,L as H,F as q,r as I,a8 as ge,B as T,d as X,_ as J,a9 as ee,O as se,aa as be,W as Se,ab as Pe,ac as Me,ad as Ie,ae as je,P as Ae,af as Oe,ag as Be,ah as Fe,ai as Ge,aj as Ke,ak as Ye,al as We,am as ce,an as Z,$ as He,ao as Je,ap as ye,aq as Re,ar as Qe,x as Ue,y as ze,as as Xe,K as Ze,A as Ne,at as es,R as ss,S as ts,au as as,av as os,aw as ls,ax as rs,ay as ns,az as is,aA as ds,aB as us,aC as ue,aD as cs,aE as ms,aF as _s}from"./index-H4DTv6Le.js";import{_ as ps,a as Le}from"./CourseOutline-Cer4xjyv.js";import{_ as Ee}from"./UserAvatar-BNFxJ-NV.js";import{_ as vs}from"./Rating.vue_vue_type_script_setup_true_lang-bpPzoqMX.js";import{_ as fs}from"./CourseInstructors-CmNKc7w9.js";import{_ as gs}from"./CourseCard-BbwRDLnH.js";import{_ as bs}from"./ECharts.vue_vue_type_script_setup_true_lang-52ImNGXD.js";import{_ as he}from"./MultiSelect-BXXjw7iZ.js";import{_ as ys}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";import{_ as hs}from"./Tabs.vue_vue_type_script_setup_true_lang-D-fQ5AHv.js";import"./vuedraggable.umd-BDbmTq6W.js";const ks={class:"border-2 rounded-md min-w-80 max-w-sm"},$s=["src"],xs={class:"p-5"},ws={key:0,class:"text-2xl font-semibold mb-3"},Cs={key:1},Vs={key:0,class:"space-y-2"},Ss={class:"space-y-4"},Ps={class:"flex items-center text-ink-gray-9"},Ms={class:"ml-2"},Rs={class:"flex items-center text-ink-gray-9"},Us={class:"ml-2"},zs={key:0,class:"flex items-center text-ink-gray-9"},Ns={class:"ml-2"},Ls={key:1,class:"flex items-center font-semibold text-ink-gray-9"},Es={class:"ml-2"},Ds={key:2,class:"flex items-center font-semibold text-ink-gray-9"},qs={class:"ml-2"},ke={__name:"CourseCardOverlay",props:{course:{type:Object,default:null}},setup(o){const h=me(),_=ne("$user"),$=window.read_only_mode,{capture:p}=De(),g=o,V=K(()=>g.course.data.video_link?"https://www.youtube.com/embed/"+g.course.data.video_link:null);function w(){_.data?Ce("frappe.client.insert",{doc:{doctype:"LMS Enrollment",course:g.course.data.name,member:_.data.name}}).then(()=>{p("enrolled_in_course",{course:g.course.data.name}),F.success(__("You have been enrolled in this course")),setTimeout(()=>{h.push({name:"Lesson",params:{courseName:g.course.data.name,chapterNumber:1,lessonNumber:1}})},1e3)}).catch(s=>{var u;F.warning(__(((u=s.messages)==null?void 0:u[0])||s)),console.error(s)}):(F.warning(__("You need to login first to enroll for this course")),setTimeout(()=>{window.location.href=`/login?redirect-to=${window.location.pathname}`},500))}const C=()=>{let s=!1;return g.course.data.instructors.forEach(u=>{var x;!s&&u.name==((x=_.data)==null?void 0:x.name)&&(s=!0)}),s},m=K(()=>{var s,u,x;return!!((s=g.course.data)!=null&&s.enable_certification&&((x=(u=g.course.data)==null?void 0:u.membership)==null?void 0:x.progress)==100)}),k=Y({url:"lms.lms.doctype.lms_certificate.lms_certificate.create_certificate",makeParams(s){return{course:s.course}},onSuccess(s){window.open(`/api/method/frappe.utils.print_format.download_pdf?doctype=LMS+Certificate&name=${s.name}&format=${encodeURIComponent(s.template)}`,"_blank")}}),P=()=>{var s,u;k.submit({course:(s=g.course.data)==null?void 0:s.name,member:(u=_.data)==null?void 0:u.name})},b=K(()=>{var s;return((s=_.data)==null?void 0:s.is_moderator)||C()});return(s,u)=>{const x=_e("router-link");return l(),c("div",ks,[o.course.data.video_link?(l(),c("iframe",{key:0,src:V.value,class:"rounded-t-md min-h-56 w-full"},null,8,$s)):y("",!0),t("div",xs,[o.course.data.paid_course?(l(),c("div",ws,d(o.course.data.price),1)):y("",!0),e($)?y("",!0):(l(),c("div",Cs,[o.course.data.membership?(l(),c("div",Vs,[r(x,{to:{name:"Lesson",params:{courseName:o.course.name,chapterNumber:o.course.data.current_lesson?o.course.data.current_lesson.split("-")[0]:1,lessonNumber:o.course.data.current_lesson?o.course.data.current_lesson.split("-")[1]:1}}},{default:f(()=>[r(e(B),{variant:"solid",size:"md",class:"w-full"},{prefix:f(()=>[r(e(fe),{class:"size-4 stroke-1.5"})]),default:f(()=>[t("span",null,d(s.__("Continue Learning")),1)]),_:1})]),_:1},8,["to"]),r(ps,{courseName:o.course.data.name,class:"w-full"},null,8,["courseName"])])):o.course.data.paid_course&&!b.value?(l(),M(x,{key:1,to:{name:"Billing",params:{type:"course",name:o.course.data.name}}},{default:f(()=>[r(e(B),{variant:"solid",size:"md",class:"w-full"},{prefix:f(()=>[r(e(qe),{class:"size-4 stroke-1.5"})]),default:f(()=>[t("span",null,d(s.__("Buy this course")),1)]),_:1})]),_:1},8,["to"])):o.course.data.disable_self_learning&&!b.value?(l(),M(e(te),{key:2,theme:"blue",size:"lg",class:"mb-4"},{default:f(()=>[j(d(s.__("Contact the Administrator to enroll for this course")),1)]),_:1})):b.value?y("",!0):(l(),M(e(B),{key:3,onClick:u[0]||(u[0]=L=>w()),variant:"solid",class:"w-full",size:"md"},{prefix:f(()=>[r(e(fe),{class:"size-4 stroke-1.5"})]),default:f(()=>[t("span",null,d(s.__("Start Learning")),1)]),_:1})),m.value?(l(),M(e(B),{key:4,onClick:u[1]||(u[1]=L=>P()),variant:"subtle",class:"w-full mt-2",size:"md"},{prefix:f(()=>[r(e(de),{class:"size-4 stroke-1.5"})]),default:f(()=>[j(" "+d(s.__("Get Certificate")),1)]),_:1})):y("",!0)])),t("div",Ss,[t("div",{class:ae(["font-medium text-ink-gray-9",{"mt-8":!e($)}])},d(s.__("This course has:")),3),t("div",Ps,[r(e(Te),{class:"h-4 w-4 stroke-1.5"}),t("span",Ms,d(o.course.data.lessons)+" "+d(s.__("Lessons")),1)]),t("div",Rs,[r(e(xe),{class:"h-4 w-4 stroke-1.5"}),t("span",Us,d(e(we)(o.course.data.enrollments))+" "+d(s.__("Enrolled Students")),1)]),parseInt(o.course.data.rating)>0?(l(),c("div",zs,[r(e(ie),{class:"size-4 stroke-1.5 fill-yellow-500 text-transparent"}),t("span",Ns,d(o.course.data.rating)+" "+d(s.__("Rating")),1)])):y("",!0),o.course.data.enable_certification?(l(),c("div",Ls,[r(e(de),{class:"h-4 w-4 stroke-2"}),t("span",Es,d(s.__("Certificate of Completion")),1)])):y("",!0),o.course.data.paid_certificate?(l(),c("div",Ds,[r(e(de),{class:"h-4 w-4 stroke-2"}),t("span",qs,d(s.__("Paid Certificate after Evaluation")),1)])):y("",!0)])])])}}},Ts={class:"flex flex-col gap-4"},Is={__name:"ReviewModal",props:ve({courseName:{type:String,required:!0}},{modelValue:{},modelModifiers:{},reloadReviews:{},reloadReviewsModifiers:{},hasReviewed:{},hasReviewedModifiers:{}}),emits:["update:modelValue","update:reloadReviews","update:hasReviewed"],setup(o){const h=Q(o,"modelValue"),_=Q(o,"reloadReviews"),$=Q(o,"hasReviewed");let p=Ve({review:"",rating:0});const g=o,V=Y({url:"frappe.client.insert",makeParams(C){return{doc:{doctype:"LMS Course Review",course:g.courseName,...C}}}});function w(C){p.rating=p.rating/5,V.submit(p,{validate(){if(!p.rating)return"Please enter a rating."},onSuccess(){_.value.reload(),$.value.reload()},onError(m){var k;F.error(((k=m.messages)==null?void 0:k[0])||m)}}),C()}return(C,m)=>(l(),M(e(pe),{modelValue:h.value,"onUpdate:modelValue":m[2]||(m[2]=k=>h.value=k),options:{title:C.__("Write a Review"),size:"xl",actions:[{label:"Submit",variant:"solid",onClick:k=>w(k)}]}},{"body-content":f(()=>[t("div",Ts,[r(e(vs),{modelValue:e(p).rating,"onUpdate:modelValue":m[0]||(m[0]=k=>e(p).rating=k),label:C.__("Rating")},null,8,["modelValue","label"]),r(e(E),{label:C.__("Review"),type:"textarea",modelValue:e(p).review,"onUpdate:modelValue":m[1]||(m[1]=k=>e(p).review=k),rows:5},null,8,["label","modelValue"])])]),_:1},8,["modelValue","options"]))}},js={key:0,class:"mt-20 mb-10"},As={class:"flex items-center font-semibold text-2xl text-ink-gray-9"},Os={class:"grid gap-8 mt-10"},Bs={class:"flex items-center"},Fs={class:"mx-4"},Gs={class:"text-lg font-medium mr-4 text-ink-gray-7"},Ks={class:"text-ink-gray-7"},Ys={class:"flex mt-2 space-x-1"},Ws={key:0,class:"mt-4 leading-5 text-ink-gray-7"},Hs={__name:"CourseReviews",props:{courseName:{type:String,required:!0},avg_rating:{type:String,required:!0},membership:{type:Object||null,required:!1}},setup(o){var w,C,m;const h=ne("$user"),_=o,$=Y({url:"frappe.client.get_count",cache:["eligible_to_review",_.courseName,(w=_.membership)==null?void 0:w.member],params:{doctype:"LMS Course Review",filters:{course:_.courseName,owner:(C=_.membership)==null?void 0:C.member}},auto:!!((m=h.data)!=null&&m.name)}),p=Y({url:"lms.lms.utils.get_reviews",cache:["course_reviews",_.courseName],makeParams(){return{course:_.courseName}},auto:!0});H(()=>_.courseName,()=>{p.reload()});const g=T(!1);function V(){g.value=!0}return(k,P)=>{var s;const b=_e("router-link");return l(),c(q,null,[(s=e(p).data)!=null&&s.length||o.membership?(l(),c("div",js,[o.membership&&!e($).data?(l(),M(e(B),{key:0,onClick:P[0]||(P[0]=u=>V()),class:"float-right"},{default:f(()=>[j(d(k.__("Write a Review")),1)]),_:1})):y("",!0),t("div",As,d(k.__("Student Reviews")),1),t("div",Os,[(l(!0),c(q,null,I(e(p).data,(u,x)=>(l(),c("div",null,[t("div",Bs,[r(b,{to:{name:"Profile",params:{username:u.owner_details.username}}},{default:f(()=>[r(Ee,{user:u.owner_details,size:"2xl"},null,8,["user"])]),_:2},1032,["to"]),t("div",Fs,[r(b,{to:{name:"Profile",params:{username:u.owner_details.username}}},{default:f(()=>[t("span",Gs,d(u.owner_details.full_name),1)]),_:2},1032,["to"]),t("span",Ks,d(u.creation),1),t("div",Ys,[(l(),c(q,null,I(5,L=>r(e(ie),{class:ae(["size-4 text-transparent rounded-sm",L<=Math.ceil(u.rating)?"fill-yellow-500":"fill-gray-300"])},null,8,["class"])),64))])])]),u.review?(l(),c("div",Ws,d(u.review),1)):y("",!0)]))),256))])])):y("",!0),r(Is,{modelValue:g.value,"onUpdate:modelValue":P[1]||(P[1]=u=>g.value=u),reloadReviews:e(p),"onUpdate:reloadReviews":P[2]||(P[2]=u=>ge(p)?p.value=u:null),hasReviewed:e($),"onUpdate:hasReviewed":P[3]||(P[3]=u=>ge($)?$.value=u:null),courseName:o.courseName},null,8,["modelValue","reloadReviews","hasReviewed","courseName"])],64)}}},Js={key:0,class:"mt-10"},Qs={class:"flex items-center justify-between mb-6"},Xs={class:"text-2xl font-semibold text-ink-gray-9"},Zs={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-4"},et={__name:"RelatedCourses",props:{courseName:{type:String,required:!0}},setup(o){const h=o,_=Y({url:"lms.lms.utils.get_related_courses",cache:["related_courses",h.courseName],makeParams(){return{course:h.courseName}},auto:!0});return H(()=>h.courseName,()=>{_.reload()}),($,p)=>{var V;const g=_e("router-link");return(V=e(_).data)!=null&&V.length?(l(),c("div",Js,[t("div",Qs,[t("div",Xs,d($.__("Related Courses")),1)]),t("div",Zs,[(l(!0),c(q,null,I(e(_).data,w=>(l(),M(g,{key:w.name,to:{name:"CourseDetail",params:{courseName:w.name}},class:"cursor-pointer"},{default:f(()=>[r(gs,{course:w},null,8,["course"])]),_:2},1032,["to"]))),128))])])):y("",!0)}}},st={class:"p-5"},tt={class:"flex justify-between w-full space-x-5"},at={class:"md:w-2/3"},ot={class:"text-3xl font-semibold text-ink-gray-9"},lt={class:"my-3 leading-6 text-ink-gray-7"},rt={class:"flex items-center"},nt={class:"ml-1 text-ink-gray-7"},it={key:1,class:"mx-3"},dt={class:"ml-1"},ut={key:3,class:"mx-3"},ct={class:"flex items-center"},mt={key:0,class:"flex my-4 w-fit"},_t={class:"md:hidden my-4"},pt=["innerHTML"],vt={class:"mt-10"},ft={class:"hidden md:block"},$e=X({__name:"CourseOverview",props:{course:{}},setup(o){return(h,_)=>(l(),c("div",st,[t("div",tt,[t("div",at,[t("div",ot,d(o.course.data.title),1),t("div",lt,d(o.course.data.short_introduction),1),t("div",rt,[parseInt(o.course.data.rating)>0?(l(),M(e(J),{key:0,text:h.__("Average Rating"),class:"flex items-center"},{default:f(()=>[r(e(ie),{class:"size-4 text-transparent fill-yellow-500"}),t("span",nt,d(o.course.data.rating),1)]),_:1},8,["text"])):y("",!0),parseInt(o.course.data.rating)>0?(l(),c("span",it,"·")):y("",!0),o.course.data.enrollment_count?(l(),M(e(J),{key:2,text:h.__("Enrolled Students"),class:"flex items-center"},{default:f(()=>[r(e(xe),{class:"h-4 w-4 text-ink-gray-7"}),t("span",dt,d(o.course.data.enrollment_count_formatted),1)]),_:1},8,["text"])):y("",!0),o.course.data.enrollment_count?(l(),c("span",ut,"·")):y("",!0),t("div",ct,[t("span",{class:ae(["h-6 mr-1",{"avatar-group overlap":o.course.data.instructors.length>1}])},[(l(!0),c(q,null,I(o.course.data.instructors,$=>(l(),M(Ee,{user:$},null,8,["user"]))),256))],2),r(fs,{instructors:o.course.data.instructors},null,8,["instructors"])])]),o.course.data.tags?(l(),c("div",mt,[(l(!0),c(q,null,I(o.course.data.tags.split(", "),$=>(l(),M(e(te),{theme:"gray",size:"lg",class:"mr-2 text-ink-gray-9"},{default:f(()=>[j(d($),1)]),_:2},1024))),256))])):y("",!0),t("div",_t,[r(ke,{course:o.course},null,8,["course"])]),t("div",{innerHTML:o.course.data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-10"},null,8,pt),t("div",vt,[r(Le,{title:h.__("Course Outline"),courseName:o.course.data.name,showOutline:!0,getProgress:!!o.course.data.membership},null,8,["title","courseName","getProgress"])]),r(Hs,{courseName:o.course.data.name,avg_rating:o.course.data.rating,membership:o.course.data.membership||null},null,8,["courseName","avg_rating","membership"])]),t("div",ft,[r(ke,{course:o.course},null,8,["course"])])]),r(et,{courseName:o.course.data.name},null,8,["courseName"])]))}}),gt={class:"space-y-4"},bt={class:"text-right"},yt=X({__name:"CourseEnrollmentModal",props:ve({course:{}},{modelValue:{type:Boolean,required:!0,default:!1},modelModifiers:{},students:{},studentsModifiers:{}}),emits:["update:modelValue","update:students"],setup(o){const h=Q(o,"modelValue"),_=T(null),$=Q(o,"students"),p=T(null),g=T(!1),V=o,w=m=>{var P;C()&&Ce("frappe.client.insert",{doc:{doctype:"LMS Enrollment",course:(P=V.course.data)==null?void 0:P.name,member:_.value,payment:g.value?p.value:null,purchased_certificate:g.value}}).then(()=>{var b;(b=$.value)==null||b.reload(),F.success(__("Student enrolled successfully")),m()}).catch(b=>{var s;F.error(__(((s=b.messages)==null?void 0:s[0])||b)),console.error(b)})},C=()=>_.value?g.value&&!p.value?(F.error(__("Please select a payment for the purchased certificate.")),!1):!0:(F.error(__("Please select a student to enroll.")),!1);return(m,k)=>(l(),M(e(pe),{modelValue:h.value,"onUpdate:modelValue":k[3]||(k[3]=P=>h.value=P),options:{title:m.__("Enroll a Student"),size:"xl"}},{"body-content":f(()=>[t("div",gt,[r(e(E),{type:"checkbox",label:m.__("Purchased Certificate"),modelValue:g.value,"onUpdate:modelValue":k[0]||(k[0]=P=>g.value=P)},null,8,["label","modelValue"]),r(ee,{doctype:"User",label:m.__("Student"),placeholder:" ",modelValue:_.value,"onUpdate:modelValue":k[1]||(k[1]=P=>_.value=P),required:!0,onCreate:()=>{e(se)("Members"),h.value=!1}},null,8,["label","modelValue","onCreate"]),g.value?(l(),M(ee,{key:0,doctype:"LMS Payment",label:m.__("Payment"),placeholder:" ",modelValue:p.value,"onUpdate:modelValue":k[2]||(k[2]=P=>p.value=P),onCreate:()=>{e(se)("Transactions"),h.value=!1}},null,8,["label","modelValue","onCreate"])):y("",!0)])]),actions:f(({close:P})=>[t("div",bt,[r(e(B),{variant:"solid",onClick:b=>w(P)},{default:f(()=>[j(d(m.__("Enroll")),1)]),_:1},8,["onClick"])])]),_:1},8,["modelValue","options"]))}}),ht={class:"border rounded-lg p-3 space-y-2"},kt={class:"text-ink-gray-5"},$t={class:"flex items-center space-x-2"},xt={class:"font-semibold text-ink-gray-9 text-2xl"},re=X({__name:"NumberChartGraph",props:{title:{},value:{}},setup(o){return(h,_)=>(l(),c("div",ht,[t("div",kt,d(h.__(o.title)),1),t("div",$t,[be(h.$slots,"prefix"),t("div",xt,d(o.value),1),be(h.$slots,"suffix")])]))}}),wt={class:"text-base text-ink-gray-9 max-h-[70vh] overflow-y-auto"},Ct={class:"flex justify-between mb-5 px-2"},Vt={class:"flex items-center space-x-2"},St={class:"font-semibold"},Pt={class:"text-ink-gray-5"},Mt={class:"w-25 space-y-2"},Rt={class:"text-ink-gray-5 text-sm"},Ut={key:0,class:"border border-outline-gray-modals rounded-lg px-3 pt-3 max-h-[60vh] overflow-y-auto"},zt={class:"text-ink-gray-5 mb-5"},Nt={class:"flex justify-between text-sm py-2 my-1"},Lt={class:""},Et={class:"mr-3 text-xs"},Dt={class:"space-y-3"},qt={key:0,class:"border border-outline-gray-modals rounded-lg px-3 pt-3 h-fit"},Tt={class:"text-ink-gray-5 mb-5"},It={class:"flex justify-between text-sm py-2 my-1"},jt={key:1,class:"border border-outline-gray-modals rounded-lg px-3 pt-3 h-fit"},At={class:"text-ink-gray-5 mb-5"},Ot={class:"flex justify-between text-sm py-2 my-1"},Bt={key:2,class:"border border-outline-gray-modals rounded-lg px-3 pt-3 h-fit"},Ft={class:"text-ink-gray-5 mb-5"},Gt={class:"flex justify-between text-sm py-2 my-1"},Kt=X({__name:"StudentCourseProgress",props:ve({course:{},student:{},lessons:{}},{modelValue:{type:Boolean,required:!0,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(o){var C,m,k,P;const h=Q(o,"modelValue"),_=o,$=Se({doctype:"LMS Course Progress",filters:{course:["=",(C=_.course.data)==null?void 0:C.name],member:["=",(m=_.student)==null?void 0:m.member]},fields:["name","lesson","status"],auto:!0}),p=Y({url:"lms.lms.api.get_course_assessment_progress",params:{course:(k=_.course.data)==null?void 0:k.name,member:(P=_.student)==null?void 0:P.member},auto:!0}),g=b=>{var s,u;return((u=(s=$.data)==null?void 0:s.find(x=>x.lesson===b.lesson))==null?void 0:u.status)||__("Pending")},V=b=>b.includes("Pass")?"green":b.includes("Fail")?"red":"orange",w=K(()=>{var b,s,u;return((b=p.data)==null?void 0:b.quizzes)&&p.data.quizzes.length>0||((s=p.data)==null?void 0:s.assignments)&&p.data.assignments.length>0||((u=p.data)==null?void 0:u.exercises)&&p.data.exercises.length>0});return(b,s)=>(l(),M(e(pe),{modelValue:h.value,"onUpdate:modelValue":s[0]||(s[0]=u=>h.value=u),options:{title:b.__("Student Progress"),size:w.value?"3xl":"xl"}},{"body-content":f(()=>{var u,x,L,D,S,U,G,A,O;return[t("div",wt,[t("div",Ct,[t("div",Vt,[r(e(Pe),{image:(u=o.student)==null?void 0:u.member_image,label:(x=o.student)==null?void 0:x.member_name,size:"xl"},null,8,["image","label"]),t("div",null,[t("div",St,d((L=o.student)==null?void 0:L.member_name),1),t("div",Pt,d(o.student.member),1)])]),t("div",Mt,[t("div",Rt,d(Math.round(o.student.progress))+"% "+d(b.__("completed")),1),r(Me,{label:b.__("Course Progress"),progress:o.student.progress},null,8,["label","progress"])])]),t("div",{class:ae(["grid gap-5",w.value?"grid-cols-2":""])},[o.lessons.data?(l(),c("div",Ut,[t("div",null,[t("div",zt,d(b.__("Lesson Progress")),1)]),(l(!0),c(q,null,I(o.lessons.data,z=>(l(),c("div",Nt,[t("div",Lt,[t("span",Et,d(z.chapter_idx)+"."+d(z.idx),1),t("span",null,d(z.title),1)]),g(z)=="Complete"?(l(),M(e(J),{key:0,text:b.__("Complete")},{default:f(()=>[r(e(Ie),{class:"text-ink-green-3 size-4"})]),_:1},8,["text"])):(l(),M(e(J),{key:1,text:b.__("Pending")},{default:f(()=>[r(e(je),{class:"text-ink-amber-2 size-4"})]),_:1},8,["text"]))]))),256))])):y("",!0),t("div",Dt,[(S=(D=e(p).data)==null?void 0:D.quizzes)!=null&&S.length?(l(),c("div",qt,[t("div",null,[t("div",Tt,d(b.__("Quiz Progress")),1)]),(l(!0),c(q,null,I(e(p).data.quizzes,z=>(l(),c("div",It,[t("div",null,d(z.quiz_title),1),t("div",null,d(z.score),1),t("div",null,d(z.percentage)+"%",1)]))),256))])):y("",!0),(G=(U=e(p).data)==null?void 0:U.assignments)!=null&&G.length?(l(),c("div",jt,[t("div",null,[t("div",At,d(b.__("Assignment Progress")),1)]),(l(!0),c(q,null,I(e(p).data.assignments,z=>(l(),c("div",Ot,[t("div",null,d(z.assignment_title),1),r(e(te),{theme:V(z.status)},{default:f(()=>[j(d(z.status),1)]),_:2},1032,["theme"])]))),256))])):y("",!0),(O=(A=e(p).data)==null?void 0:A.exercises)!=null&&O.length?(l(),c("div",Bt,[t("div",null,[t("div",Ft,d(b.__("Programming Exercise Progress")),1)]),(l(!0),c(q,null,I(e(p).data.exercises,z=>(l(),c("div",Gt,[t("div",null,d(z.exercise_title),1),r(e(te),{theme:V(z.status)},{default:f(()=>[j(d(z.status),1)]),_:2},1032,["theme"])]))),256))])):y("",!0)])],2)])]}),_:1},8,["modelValue","options"]))}}),Yt={class:"p-5"},Wt={class:"grid grid-cols-4 gap-5 mb-5 text-ink-gray-9"},Ht={class:"grid grid-cols-[2fr_1fr] gap-5 items-start"},Jt={class:"border rounded-lg py-3 px-4"},Qt={class:"flex items-center justify-between mb-3"},Xt={class:"text-lg text-ink-gray-9 font-semibold"},Zt={class:"flex items-center space-x-2"},ea={key:0,class:"max-h-[63vh] overflow-y-auto"},sa={key:0},ta={key:0},aa={key:1,class:"text-xs !mx-0 w-5"},oa={key:2},la={key:0,class:"flex justify-center my-3"},ra={class:"space-y-5"},na={key:0,class:"border rounded-lg p-4"},ia={class:"text-ink-gray-5 mb-4"},da={class:"grid grid-cols-[2fr_1fr] items-center justify-between text-ink-gray-9"},ua={class:"flex flex-col space-y-4 flex-1 text-sm"},ca={class:"flex items-center text-ink-gray-7"},ma={class:"ml-2"},_a={class:"ml-auto"},pa={key:1,class:"border rounded-lg pt-4 px-4"},va={class:"flex items-center justify-between mb-4"},fa={class:"text-ink-gray-5"},ga={class:"divide-y max-h-[43vh divide-outline-gray-modals text-ink-gray-7 overflow-y-auto"},ba={class:"flex justify-between text-sm py-2 my-1 text-ink-gray-9"},ya={class:""},ha={class:"mr-3 text-xs"},ka=X({__name:"CourseDashboard",props:{course:{}},setup(o){var x,L,D;const h=o,_=T(!1),$=T(null),p=T(!1),g=T(null),V=T(localStorage.getItem("theme")=="dark"?"darkMode":"lightMode"),w=Y({url:"lms.lms.api.get_course_progress_distribution",makeParams(){var S;return{course:(S=h.course.data)==null?void 0:S.name}},auto:!0}),C=Se({doctype:"LMS Enrollment",filters:{course:(x=h.course.data)==null?void 0:x.name},fields:["name","member","member_name","member_image","member_username","progress","creation"],pageLength:100,auto:!0,cache:["courseProgress",(L=h.course.data)==null?void 0:L.name]}),m=Y({url:"lms.lms.api.get_lesson_completion_stats",params:{course:(D=h.course.data)==null?void 0:D.name},auto:!0}),k=S=>{var U,G;S=="completion_rate"?(U=m.data)==null||U.sort((A,O)=>{var W,n;const z=A.completion_count/(((W=h.course.data)==null?void 0:W.enrollments)||1);return O.completion_count/(((n=h.course.data)==null?void 0:n.enrollments)||1)-z}):S=="index"&&((G=m.data)==null||G.sort((A,O)=>A.chapter_idx-O.chapter_idx||A.idx-O.idx))};H([$],()=>{var U;let S={course:(U=h.course.data)==null?void 0:U.name};$.value&&(S.member_name=["like",`%${$.value}%`]),C.update({filters:S}),C.reload()});const P=K(()=>{var U;return(Math.ceil((U=w.data)==null?void 0:U.average_progress)||0)+"%"}),b=K(()=>{let S=[];return S.push(Z[V.value].red[400]),S.push(Z[V.value].amber[400]),S.push(Z[V.value].blue[400]),S.push(Z[V.value].green[400]),S}),s=K(()=>[{label:__("Name"),key:"member_name",width:"40%"},{label:__("Progress"),key:"progress",width:"30%"},{label:__("Start Date"),key:"creation",align:"right"}]),u=[{label:__("Lesson Index"),value:"index",onClick(){k("index")}},{label:__("Completion Rate"),value:"completion_rate",onClick(){k("completion_rate")}}];return(S,U)=>{var G,A,O,z,R,W,n,a;return l(),c(q,null,[t("div",Yt,[t("div",Wt,[r(re,{title:S.__("Enrolled"),value:e(we)((G=o.course.data)==null?void 0:G.enrollments)},null,8,["title","value"]),r(re,{title:S.__("Average Completion Rate"),value:P.value},null,8,["title","value"]),r(re,{title:S.__("Average Rating"),value:((A=o.course.data)==null?void 0:A.rating)||0},{prefix:f(()=>[r(e(ie),{class:"size-5 text-transparent fill-amber-500"})]),_:1},8,["title","value"]),r(re,{title:S.__("Lessons"),value:(O=o.course.data)==null?void 0:O.lessons},null,8,["title","value"])]),t("div",Ht,[t("div",Jt,[t("div",Qt,[t("div",Xt,d(S.__("Students")),1),t("div",Zt,[r(e(E),{modelValue:$.value,"onUpdate:modelValue":U[0]||(U[0]=v=>$.value=v),placeholder:S.__("Search by name"),type:"text"},null,8,["modelValue","placeholder"]),r(e(B),{onClick:U[1]||(U[1]=v=>_.value=!0)},{prefix:f(()=>[r(e(Ae),{class:"size-4 stroke-1.5"})]),default:f(()=>[j(" "+d(S.__("Enroll")),1)]),_:1})])]),e(C).loading||(z=e(C).data)!=null&&z.length?(l(),c("div",ea,[r(e(We),{columns:s.value,rows:e(C).data,rowKey:"name",options:{selectable:!1,showTooltip:!1}},{default:f(()=>[r(e(Oe),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-white border-b rounded-none p-2"},{default:f(()=>[(l(!0),c(q,null,I(s.value,v=>(l(),M(e(Be),{item:v,key:v.key},null,8,["item"]))),128))]),_:1}),(l(!0),c(q,null,I(e(C).data,v=>(l(),M(e(Ye),{class:"max-h-[500px]"},{default:f(()=>[r(e(Fe),{row:v,onClick:()=>{p.value=!0,g.value=v},class:"cursor-pointer"},{default:f(({column:N,item:oe})=>[r(e(Ge),{item:v[N.key],align:N.align,class:"w-full"},{prefix:f(()=>[N.key=="member_name"?(l(),c("div",sa,[r(e(Pe),{class:"flex items-center",image:v.member_image,label:oe,size:"sm"},null,8,["image","label"])])):N.key=="progress"?(l(),M(Me,{key:1,progress:Math.ceil(v[N.key]),class:"!mx-0 !mr-4"},null,8,["progress"])):y("",!0)]),default:f(()=>[N.key=="creation"?(l(),c("div",ta,d(e(Ke)(v[N.key]).format("DD MMM YYYY")),1)):N.key=="progress"?(l(),c("div",aa,d(Math.ceil(v[N.key]))+"% ",1)):(l(),c("div",oa,d(v[N.key].toString()),1))]),_:2},1032,["item","align"])]),_:2},1032,["row","onClick"])]),_:2},1024))),256))]),_:1},8,["columns","rows"]),e(C).data&&e(C).hasNextPage?(l(),c("div",la,[r(e(B),{onClick:U[2]||(U[2]=v=>e(C).next())},{default:f(()=>[j(d(S.__("Load More")),1)]),_:1})])):y("",!0)])):y("",!0)]),t("div",ra,[((R=e(w).data)==null?void 0:R.average_progress)>0?(l(),c("div",na,[t("div",ia,d(S.__("Progress Summary")),1),t("div",da,[t("div",ua,[(l(!0),c(q,null,I((W=e(w).data)==null?void 0:W.progress_distribution,v=>(l(),c("div",ca,[t("div",{class:"size-2 rounded",style:ce({backgroundColor:e(Z)[V.value][v.name.startsWith("Just")?"red":v.name.startsWith("In")?"amber":v.name.startsWith("Adv")?"blue":"green"][400]})},null,4),r(e(J),{text:v.name.split("(")[1].replace(")","")},{default:f(()=>[t("div",ma,d(v.name.split("(")[0]),1)]),_:2},1032,["text"]),r(e(J),{text:v.value},{default:f(()=>{var N;return[t("div",_a,d(Math.round(v.value/((N=o.course.data)==null?void 0:N.enrollments)*100))+"% ",1)]}),_:2},1032,["text"])]))),256))]),r(e(bs),{class:"w-40 h-20",options:{color:b.value,series:[{type:"pie",radius:["50%","70%"],center:["50%","50%"],label:{show:!1},labelLine:{show:!1},emphasis:{label:{show:!1},scale:!1},legend:{show:!1},data:((n=e(w).data)==null?void 0:n.progress_distribution)||[]}],showInlineLabels:!1}},null,8,["options"])])])):y("",!0),(a=e(m).data)!=null&&a.length?(l(),c("div",pa,[t("div",va,[t("div",fa,d(S.__("Lesson Completion")),1),r(e(He),{options:u,"onUpdate:modelValue":U[3]||(U[3]=v=>k(v)),placeholder:S.__("Sort by"),class:"!w-32"},null,8,["placeholder"])]),t("div",ga,[(l(!0),c(q,null,I(e(m).data,v=>(l(),c("div",ba,[t("div",ya,[t("span",ha,d(v.chapter_idx)+"."+d(v.idx),1),t("span",null,d(v.title),1)]),r(e(J),{text:v.completion_count},{default:f(()=>{var N;return[t("div",null,d(Math.ceil(v.completion_count/((N=o.course.data)==null?void 0:N.enrollments)*100))+"% ",1)]}),_:2},1032,["text"])]))),256))])])):y("",!0)])])]),_.value?(l(),M(yt,{key:0,modelValue:_.value,"onUpdate:modelValue":U[4]||(U[4]=v=>_.value=v),course:o.course,students:e(C)},null,8,["modelValue","course","students"])):y("",!0),p.value?(l(),M(Kt,{key:1,modelValue:p.value,"onUpdate:modelValue":U[5]||(U[5]=v=>p.value=v),course:o.course,student:g.value,lessons:e(m)},null,8,["modelValue","course","student","lessons"])):y("",!0)],64)}}}),$a={class:"text-xs text-ink-gray-5 mb-1"},xa={class:"space-y-2"},wa={class:"rounded-lg bg-surface-white p-3 border w-fit mt-2"},Ca={class:"text-xs text-ink-gray-5 mb-1.5"},Va={class:"grid grid-cols-7 gap-2"},Sa=["onClick"],Pa={class:"text-sm text-ink-gray-5 mt-2"},Ma=X({__name:"ColorSwatches",props:{modelValue:{},label:{},description:{}},emits:["update:modelValue","change"],setup(o,{emit:h}){const _=h,$=K(()=>["Red","Blue","Green","Amber","Purple","Cyan","Orange","Violet","Pink","Teal","Gray","Yellow"]);return(p,g)=>(l(),c("div",null,[t("div",$a,d(p.__(o.label)),1),r(e(Je),{placement:"bottom",class:"!block"},{target:f(({togglePopover:V,isOpen:w})=>[t("div",xa,[r(e(E),{type:"text",autocomplete:"off",class:"w-full",placeholder:p.__("Set Color"),onFocus:V,modelValue:o.modelValue,"onUpdate:modelValue":g[1]||(g[1]=C=>_("update:modelValue",C))},{prefix:f(()=>[t("div",{class:"size-4 rounded-full",style:ce(o.modelValue?{backgroundColor:e(ye)(o.modelValue.toLowerCase(),400)}:{})},[o.modelValue?y("",!0):(l(),M(e(Qe),{key:0,class:"size-4 stroke-1.5 text-ink-gray-5"}))],4)]),suffix:f(()=>[r(e(B),{variant:"ghost"},{default:f(()=>[r(e(Re),{class:"size-3 text-ink-gray-5",onClick:g[0]||(g[0]=C=>_("update:modelValue",null))})]),_:1})]),_:1},8,["placeholder","onFocus","modelValue"])])]),body:f(({close:V})=>[t("div",wa,[t("div",Ca,d(p.__("Swatches")),1),t("div",Va,[(l(!0),c(q,null,I($.value,w=>(l(),c("div",{key:w,class:"size-5 rounded-full cursor-pointer",style:ce({backgroundColor:e(ye)(w.toLowerCase(),400)}),onClick:C=>{_("update:modelValue",w),V(),_("change",w)}},null,12,Sa))),128))])])]),_:1}),t("div",Pa,d(o.description),1)]))}}),Ra={class:"pl-5"},Ua={class:"grid grid-cols-1 md:grid-cols-[70%,30%] overflow-hidden"},za={key:0,class:"h-[88vh] overflow-y-auto"},Na={class:"my-5"},La={class:"pr-5 md:pr-10 pb-5 mb-5 space-y-5 border-b"},Ea={class:"text-lg font-semibold mb-4 text-ink-gray-9"},Da={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},qa={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},Ta={class:"text-xs text-ink-gray-5"},Ia={class:"flex items-center flex-wrap gap-2"},ja={class:"flex items-center bg-surface-gray-2 text-ink-gray-7 p-2 rounded-md"},Aa={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},Oa={class:"pr-5 md:pr-10 pb-5 mb-5 space-y-5 border-b"},Ba={class:"text-lg font-semibold text-ink-gray-9"},Fa={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},Ga={key:0,class:"flex flex-col space-y-5"},Ka={class:"flex flex-col space-y-5"},Ya={class:"pr-5 md:pr-10 pb-5 mb-5 space-y-5 border-b"},Wa={class:"text-lg font-semibold text-ink-gray-9"},Ha={class:""},Ja={class:"mb-1.5 text-sm text-ink-gray-5"},Qa={class:"pr-5 md:pr-10 pb-5 space-y-5 border-b"},Xa={class:"text-lg font-semibold mt-5 text-ink-gray-9"},Za={class:"grid grid-cols-1 md:grid-cols-3 gap-5"},eo={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},so={class:"space-y-5"},to={class:"space-y-5"},ao={class:"pr-5 md:pr-10 pb-5 space-y-5"},oo={class:"text-lg font-semibold mt-5 text-ink-gray-9"},lo={class:"space-y-5"},ro={class:"border-l h-[88vh] overflow-y-auto"},no={__name:"CourseForm",props:{course:{type:Object}},setup(o,{expose:h}){var W;const _=ne("$user"),$=T(""),{brand:p}=Ue(),g=me(),V=T([]),w=T([]),C=as(),{$dialog:m}=C.appContext.config.globalProperties,k=T(!1),P=o,b=Ve({description:"",keywords:""});ze(()=>{var n,a;!((n=_.data)!=null&&n.is_moderator)&&!((a=_.data)!=null&&a.is_instructor)&&g.push({name:"Courses"}),window.addEventListener("keydown",S)});const s=Xe({doctype:"LMS Course",name:(W=P.course.data)==null?void 0:W.name,auto:!0});H(()=>s.doc,()=>{var n;z(),ns("courses",(n=s.doc)==null?void 0:n.name,b),u()});const u=()=>{Object.keys(s.doc).forEach(a=>{a=="instructors"?(V.value=[],s.doc.instructors.forEach(v=>{V.value.push(v.instructor)})):a=="related_courses"&&(w.value=[],s.doc.related_courses.forEach(v=>{w.value.push(v.course)}))});let n=["published","upcoming","disable_self_learning","paid_course","featured","enable_certification","paid_certificate"];for(let a in n){let v=n[a];s.doc[v]=!!s.doc[v]}},x=()=>{L(),D()},L=()=>{s.doc.description=os(s.doc.description),Object.keys(s.doc).forEach(n=>{n!="description"&&typeof s.doc[n]=="string"&&(s.doc[n]=ls(s.doc[n]))})},D=()=>{s.setValue.submit({...s.doc,instructors:V.value.map(n=>({instructor:n})),related_courses:w.value.map(n=>({course:n}))},{onSuccess(){var n;rs("courses",(n=s.doc)==null?void 0:n.name,b),F.success(__("Course updated successfully")),k.value=!1,s.reload()},onError(n){var a;F.error(((a=n.messages)==null?void 0:a[0])||n),console.error(n)}})},S=n=>{n.key==="s"&&(n.ctrlKey||n.metaKey)&&!n.target.classList.contains("ProseMirror")&&(x(),n.preventDefault())};Ze(()=>{window.removeEventListener("keydown",S)});const U=Y({url:"lms.lms.api.delete_course",makeParams(n){var a;return{course:(a=s.doc)==null?void 0:a.name}},onSuccess(){F.success(__("Course deleted successfully")),g.push({name:"Courses"})}}),G=()=>{m({title:__("Delete Course"),message:__("Deleting the course will also delete all its chapters and lessons. Are you sure you want to delete this course?"),actions:[{label:__("Delete"),theme:"red",variant:"solid",onClick(n){U.submit(),n()}}]})},A=()=>{$.value&&(s.doc.tags=s.doc.tags?`${s.doc.tags}, ${$.value}`:$.value,$.value="",R())},O=n=>{var a;s.doc.tags=(a=s.doc.tags)==null?void 0:a.split(", ").filter(v=>v!==n).join(", "),$.value="",R()},z=()=>{var a;let n=!1;(a=_.data)!=null&&a.is_moderator||(V.value.forEach(v=>{var N;!n&&v==((N=_.data)==null?void 0:N.name)&&(n=!0)}),n||g.push({name:"Courses"}))},R=()=>{k.value=!0};return Ne(()=>{var n;return{title:(n=s.doc)==null?void 0:n.title,icon:p.favicon}}),h({submitCourse:x,trashCourse:G,isDirty:k}),(n,a)=>{var v,N,oe;return l(),c("div",Ra,[t("div",Ua,[e(s).doc?(l(),c("div",za,[t("div",Na,[t("div",La,[t("div",Ea,d(n.__("Details")),1),t("div",Da,[r(e(E),{modelValue:e(s).doc.title,"onUpdate:modelValue":a[0]||(a[0]=i=>e(s).doc.title=i),label:n.__("Title"),required:!0,onInput:a[1]||(a[1]=i=>R())},null,8,["modelValue","label"]),r(ee,{doctype:"LMS Category",modelValue:e(s).doc.category,"onUpdate:modelValue":[a[2]||(a[2]=i=>e(s).doc.category=i),a[3]||(a[3]=i=>R())],label:n.__("Category"),onCreate:(i,le)=>e(se)("Categories",le)},null,8,["modelValue","label","onCreate"])]),t("div",qa,[r(he,{modelValue:V.value,"onUpdate:modelValue":[a[4]||(a[4]=i=>V.value=i),a[5]||(a[5]=i=>R())],doctype:"User",label:n.__("Instructors"),filters:{ignore_user_type:1},onCreate:i=>e(se)("Members",i),required:!0},null,8,["modelValue","label","onCreate"]),t("div",null,[t("div",Ta,d(n.__("Tags")),1),r(e(E),{modelValue:$.value,"onUpdate:modelValue":a[6]||(a[6]=i=>$.value=i),placeholder:n.__("Add a keyword and then press enter"),class:ae(["w-full","flex-1","my-1"]),onKeyup:a[7]||(a[7]=es(i=>A(),["enter"])),id:"tags"},null,8,["modelValue","placeholder"]),t("div",null,[t("div",Ia,[e(s).doc.tags?(l(!0),c(q,{key:0},I((v=e(s).doc.tags)==null?void 0:v.split(", "),i=>(l(),c("div",ja,[j(d(i)+" ",1),r(e(Re),{class:"stroke-1.5 w-3 h-3 ml-2 cursor-pointer",onClick:le=>O(i)},null,8,["onClick"])]))),256)):y("",!0)])])])]),t("div",Aa,[r(ss,{modelValue:e(s).doc.image,"onUpdate:modelValue":[a[8]||(a[8]=i=>e(s).doc.image=i),a[9]||(a[9]=i=>R())],label:n.__("Course Image"),required:!1},null,8,["modelValue","label"]),r(Ma,{modelValue:e(s).doc.card_gradient,"onUpdate:modelValue":[a[10]||(a[10]=i=>e(s).doc.card_gradient=i),a[11]||(a[11]=i=>R())],label:n.__("Color"),description:n.__("Choose a color for the course card"),class:"w-full"},null,8,["modelValue","label","description"])])]),t("div",Oa,[t("div",Ba,d(n.__("Settings")),1),t("div",Fa,[(N=e(_).data)!=null&&N.is_moderator?(l(),c("div",Ga,[r(e(E),{type:"checkbox",modelValue:e(s).doc.published,"onUpdate:modelValue":a[12]||(a[12]=i=>e(s).doc.published=i),label:n.__("Published"),onChange:a[13]||(a[13]=i=>R())},null,8,["modelValue","label"]),r(e(E),{modelValue:e(s).doc.published_on,"onUpdate:modelValue":a[14]||(a[14]=i=>e(s).doc.published_on=i),label:n.__("Published On"),type:"date",onChange:a[15]||(a[15]=i=>R())},null,8,["modelValue","label"])])):y("",!0),t("div",Ka,[r(e(E),{type:"checkbox",modelValue:e(s).doc.upcoming,"onUpdate:modelValue":a[16]||(a[16]=i=>e(s).doc.upcoming=i),label:n.__("Upcoming"),onChange:a[17]||(a[17]=i=>R())},null,8,["modelValue","label"]),r(e(E),{type:"checkbox",modelValue:e(s).doc.featured,"onUpdate:modelValue":a[18]||(a[18]=i=>e(s).doc.featured=i),label:n.__("Featured"),onChange:a[19]||(a[19]=i=>R())},null,8,["modelValue","label"]),r(e(E),{type:"checkbox",modelValue:e(s).doc.disable_self_learning,"onUpdate:modelValue":a[20]||(a[20]=i=>e(s).doc.disable_self_learning=i),label:n.__("Disable Self Enrollment"),onChange:a[21]||(a[21]=i=>R())},null,8,["modelValue","label"])])])]),t("div",Ya,[t("div",Wa,d(n.__("About the Course")),1),r(e(E),{modelValue:e(s).doc.short_introduction,"onUpdate:modelValue":a[22]||(a[22]=i=>e(s).doc.short_introduction=i),type:"textarea",rows:5,label:n.__("Short Introduction"),placeholder:n.__("A one line introduction to the course that appears on the course card"),required:!0,onChange:a[23]||(a[23]=i=>R())},null,8,["modelValue","label","placeholder"]),t("div",Ha,[t("div",Ja,[j(d(n.__("Course Description"))+" ",1),a[47]||(a[47]=t("span",{class:"text-ink-red-3"},"*",-1))]),r(e(ts),{content:e(s).doc.description,onChange:a[24]||(a[24]=i=>{e(s).doc.description=i,R()}),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x border-outline-gray-modals bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem]"},null,8,["content"])]),r(e(E),{modelValue:e(s).doc.video_link,"onUpdate:modelValue":a[25]||(a[25]=i=>e(s).doc.video_link=i),label:n.__("Preview Video"),placeholder:n.__("Paste the youtube link of a short video introducing the course"),onInput:a[26]||(a[26]=i=>R())},null,8,["modelValue","label","placeholder"]),r(he,{modelValue:w.value,"onUpdate:modelValue":[a[27]||(a[27]=i=>w.value=i),a[28]||(a[28]=i=>R())],doctype:"LMS Course",label:n.__("Related Courses"),filters:{name:["!=",(oe=e(s).doc)==null?void 0:oe.name]},onCreate:i=>{e(g).push({name:"Courses",query:{newCourse:"1"}})}},null,8,["modelValue","label","filters","onCreate"])]),t("div",Qa,[t("div",Xa,d(n.__("Pricing and Certification")),1),t("div",Za,[r(e(E),{type:"checkbox",modelValue:e(s).doc.paid_course,"onUpdate:modelValue":a[29]||(a[29]=i=>e(s).doc.paid_course=i),label:n.__("Paid Course"),onChange:a[30]||(a[30]=i=>R())},null,8,["modelValue","label"]),r(e(E),{type:"checkbox",modelValue:e(s).doc.enable_certification,"onUpdate:modelValue":a[31]||(a[31]=i=>e(s).doc.enable_certification=i),label:n.__("Completion Certificate"),onChange:a[32]||(a[32]=i=>R())},null,8,["modelValue","label"]),r(e(E),{type:"checkbox",modelValue:e(s).doc.paid_certificate,"onUpdate:modelValue":a[33]||(a[33]=i=>e(s).doc.paid_certificate=i),label:n.__("Paid Certificate"),onChange:a[34]||(a[34]=i=>R())},null,8,["modelValue","label"])]),t("div",eo,[t("div",so,[e(s).doc.paid_course||e(s).doc.paid_certificate?(l(),M(e(E),{key:0,modelValue:e(s).doc.course_price,"onUpdate:modelValue":a[35]||(a[35]=i=>e(s).doc.course_price=i),label:n.__("Amount"),required:e(s).doc.paid_course||e(s).doc.paid_certificate,onInput:a[36]||(a[36]=i=>R())},null,8,["modelValue","label","required"])):y("",!0),e(s).doc.paid_certificate?(l(),M(ee,{key:1,doctype:"Course Evaluator",modelValue:e(s).doc.evaluator,"onUpdate:modelValue":[a[37]||(a[37]=i=>e(s).doc.evaluator=i),a[38]||(a[38]=i=>R())],label:n.__("Evaluator"),required:e(s).doc.paid_certificate,onCreate:(i,le)=>e(se)("Evaluators",le)},null,8,["modelValue","label","required","onCreate"])):y("",!0)]),t("div",to,[e(s).doc.paid_course||e(s).doc.paid_certificate?(l(),M(ee,{key:0,doctype:"Currency",modelValue:e(s).doc.currency,"onUpdate:modelValue":[a[39]||(a[39]=i=>e(s).doc.currency=i),a[40]||(a[40]=i=>R())],filters:{enabled:1},label:n.__("Currency"),required:e(s).doc.paid_course||e(s).doc.paid_certificate},null,8,["modelValue","label","required"])):y("",!0),e(s).doc.paid_certificate?(l(),M(e(E),{key:1,modelValue:e(s).doc.timezone,"onUpdate:modelValue":a[41]||(a[41]=i=>e(s).doc.timezone=i),label:n.__("Timezone"),required:e(s).doc.paid_certificate,placeholder:n.__("e.g. IST, UTC, GMT..."),onInput:a[42]||(a[42]=i=>R())},null,8,["modelValue","label","required","placeholder"])):y("",!0)])])]),t("div",ao,[t("div",oo,d(n.__("Meta Tags")),1),t("div",lo,[r(e(E),{modelValue:b.description,"onUpdate:modelValue":a[43]||(a[43]=i=>b.description=i),label:n.__("Meta Description"),type:"textarea",rows:7,onInput:a[44]||(a[44]=i=>R())},null,8,["modelValue","label"]),r(e(E),{modelValue:b.keywords,"onUpdate:modelValue":a[45]||(a[45]=i=>b.keywords=i),label:n.__("Meta Keywords"),type:"textarea",rows:7,placeholder:n.__("Comma separated keywords for SEO"),onInput:a[46]||(a[46]=i=>R())},null,8,["modelValue","label","placeholder"])])])])])):y("",!0),t("div",ro,[e(s).doc?(l(),M(Le,{key:0,courseName:e(s).doc.name,title:n.__("Chapters"),allowEdit:!0},null,8,["courseName","title"])):y("",!0)])])])}}},io={key:0},uo={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},co={key:0,class:"flex items-center space-x-2"},mo={key:1},wo={__name:"CourseDetail",props:{courseName:{type:String,required:!0}},setup(o){const{brand:h}=Ue(),_=me(),$=_s(),p=ne("$user"),g=T(0),V=T(null),w=o;ze(()=>{C()});const C=()=>{const u=$.hash;u&&k.value.forEach((x,L)=>{var D;((D=x.label)==null?void 0:D.toLowerCase())===u.replace("#","")&&(g.value=L)})};H(g,()=>{const u=k.value[g.value];u.label!=$.hash.replace("#","")&&_.push({...$,hash:`#${u.label.toLowerCase()}`})});const m=Y({url:"lms.lms.utils.get_course_details",cache:["course",w.courseName],makeParams(){return{course:w.courseName}},auto:!0}),k=T([{label:__("Overview"),component:ue($e),icon:is},{label:__("Dashboard"),component:ue(ka),icon:ds},{label:__("Settings"),component:ue(no),icon:us}]);H(()=>w.courseName,()=>{m.reload()}),H(m,()=>{var u,x;!b.value&&!((u=m.data)!=null&&u.published)&&!((x=m.data)!=null&&x.upcoming)&&_.push({name:"Courses"})});const P=()=>{var x;let u=!1;return(x=m.data)==null||x.instructors.forEach(L=>{var D;!u&&L.name==((D=p.data)==null?void 0:D.name)&&(u=!0)}),u},b=K(()=>{var u;return((u=p.data)==null?void 0:u.is_moderator)||P()}),s=K(()=>{var x,L;let u=[{label:__("Courses"),route:{name:"Courses"}}];return u.push({label:(x=m==null?void 0:m.data)==null?void 0:x.title,route:{name:"CourseDetail",params:{courseName:(L=m==null?void 0:m.data)==null?void 0:L.name}}}),u});return Ne(()=>{var u;return{title:(u=m==null?void 0:m.data)==null?void 0:u.title,icon:h.favicon}}),(u,x)=>{var L;return e(m).data?(l(),c("div",io,[t("header",uo,[r(e(ys),{class:"h-7",items:s.value},null,8,["items"]),g.value==2?(l(),c("div",co,[(L=V.value)!=null&&L.isDirty?(l(),M(e(te),{key:0,theme:"orange"},{default:f(()=>[j(d(u.__("Not Saved")),1)]),_:1})):y("",!0),r(e(B),{onClick:x[0]||(x[0]=D=>V.value.trashCourse())},{icon:f(()=>[r(e(cs),{class:"w-4 h-4 stroke-1.5"})]),_:1}),r(e(B),{variant:"solid",onClick:x[1]||(x[1]=D=>V.value.submitCourse())},{default:f(()=>[j(d(u.__("Save")),1)]),_:1})])):y("",!0)]),b.value?(l(),c("div",mo,[r(e(hs),{tabs:k.value,modelValue:g.value,"onUpdate:modelValue":x[2]||(x[2]=D=>g.value=D)},{"tab-panel":f(({tab:D})=>[(l(),M(ms(D.component),{course:e(m),ref_key:"childRef",ref:V},null,8,["course"]))]),_:1},8,["tabs","modelValue"])])):(l(),M($e,{key:0,course:e(m)},null,8,["course"]))])):y("",!0)}}};export{wo as default};
//# sourceMappingURL=CourseDetail-BsxOf48R.js.map
