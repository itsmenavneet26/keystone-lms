import{d as T,x as D,y as U,W as A,L as z,E as p,A as I,a as c,b as f,e as r,u as s,t as y,a9 as P,N as K,f as v,l as g,w as u,al as O,p as V,F as h,i as F,B as W,q as G,o,r as C,ag as H,bx as J,af as Q,ah as X,ai as Y,a2 as Z,k as M,ab as ee,ak as se,aD as ae,bp as te,T as re,g as ie}from"./index-H4DTv6Le.js";import{_ as le}from"./EmptyState.vue_vue_type_script_setup_true_lang-C4EPuQXe.js";import{_ as oe}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";const ne={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},ue={class:"p-6"},me={class:"flex items-center justify-between space-x-32 mb-5"},ce={class:"text-lg font-semibold text-ink-gray-9"},de={key:0,class:"grid grid-cols-3 gap-5"},_e={key:0},fe={key:0},ye={key:1,class:"text-sm text-ink-gray-5"},be={key:2},ge={class:"flex gap-2"},pe={key:2,class:"flex justify-center my-5"},$e=T({__name:"ProgrammingExerciseSubmissions",setup(ve){const{brand:N}=D(),R=F("$dayjs"),b=F("$user"),k=["exercise","member","status"],n=W({exercise:"",member:"",status:""}),d=G();U(()=>{q(),B()});const q=()=>{k.forEach(e=>{d.currentRoute.value.query[e]&&(n.value[e]=d.currentRoute.value.query[e])})},B=()=>{var e;x.value?n.value.member=(e=b.data)==null?void 0:e.name:i.reload()},i=A({doctype:"LMS Programming Exercise Submission",fields:["name","exercise","exercise_title","member_name","member_image","status","modified"],orderBy:"modified desc",transform(e){return e.map(a=>({...a,modified:R(a.modified).fromNow()}))}});z(n.value,()=>{let e={};k.forEach(a=>{if(n.value[a])e[a]=n.value[a],d.push({query:{...d.currentRoute.value.query,[a]:n.value[a]}});else{delete e[a];const m={...d.currentRoute.value.query};delete m[a],d.push({query:m})}}),i.update({filters:{...e}}),i.reload()});const j=(e,a)=>{Array.from(e).forEach(async m=>{await i.delete.submit(m)}),a(),re.success(__("Submissions deleted successfully"))},x=p(()=>{var e,a,m;return!((e=b.data)!=null&&e.is_instructor)&&!((a=b.data)!=null&&a.is_moderator)&&!((m=b.data)!=null&&m.is_evaluator)}),$=p(()=>[{label:__("Member"),key:"member_name",width:"30%",icon:"user"},{label:__("Exercise"),key:"exercise_title",width:"30%",icon:"code"},{label:__("Status"),key:"status",width:"20%",icon:"check-circle"},{label:__("Modified"),key:"modified",width:"15%",icon:"clock",align:"right"}]),L=p(()=>[{label:__("Programming Exercise Submissions"),route:{name:"ProgrammingExerciseSubmissions"}}]);return I(()=>({title:__("Programming Exercises"),icon:N.favicon})),(e,a)=>{var S,E,w;const m=ie("router-link");return o(),c(h,null,[f("header",ne,[r(s(oe),{items:L.value},null,8,["items"])]),f("div",ue,[f("div",me,[f("div",ce,y((S=s(i).data)!=null&&S.length?e.__("{0} Submissions").format(s(i).data.length):e.__("No Submissions")),1),(E=s(i).data)!=null&&E.length?(o(),c("div",de,[r(P,{doctype:"LMS Programming Exercise",modelValue:n.value.exercise,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.exercise=t),placeholder:e.__("Filter by Exercise"),class:"w-40"},null,8,["modelValue","placeholder"]),r(P,{doctype:"User",modelValue:n.value.member,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.member=t),placeholder:e.__("Filter by Member"),readonly:x.value,class:"w-40"},null,8,["modelValue","placeholder","readonly"]),r(s(K),{modelValue:n.value.status,"onUpdate:modelValue":a[2]||(a[2]=t=>n.value.status=t),type:"select",options:[{label:e.__(""),value:""},{label:e.__("Passed"),value:"Passed"},{label:e.__("Failed"),value:"Failed"}],placeholder:e.__("Filter by Status"),class:"w-40"},null,8,["modelValue","options","placeholder"])])):v("",!0)]),s(i).loading||(w=s(i).data)!=null&&w.length?(o(),g(s(O),{key:0,columns:$.value,rows:s(i).data,rowKey:"name",options:{selectable:!0,showTooltip:!1}},{default:u(()=>[r(s(Q),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:u(()=>[(o(!0),c(h,null,C($.value,t=>(o(),g(s(H),{item:t,key:t.key},{prefix:u(({item:l})=>{var _;return[r(s(J),{name:(_=l.icon)==null?void 0:_.toString(),class:"h-4 w-4"},null,8,["name"])]}),_:2},1032,["item"]))),128))]),_:1}),r(s(se),null,{default:u(()=>[(o(!0),c(h,null,C(s(i).data,t=>(o(),g(m,{to:{name:"ProgrammingExerciseSubmission",params:{exerciseID:t.exercise,submissionID:t.name}}},{default:u(()=>[r(s(X),{row:t,class:"hover:bg-surface-gray-1"},{default:u(({column:l,item:_})=>[r(s(Y),{item:t[l.key],align:l.align},{prefix:u(()=>[l.key=="member_name"?(o(),c("div",_e,[r(s(ee),{class:"flex items-center",image:t.member_image,label:_,size:"sm"},null,8,["image","label"])])):v("",!0)]),default:u(()=>[l.key=="status"?(o(),c("div",fe,[r(s(Z),{theme:t[l.key]==="Passed"?"green":"red"},{default:u(()=>[M(y(t[l.key]),1)]),_:2},1032,["theme"])])):l.key=="modified"?(o(),c("div",ye,y(t[l.key]),1)):(o(),c("div",be,y(t[l.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1}),r(s(te),null,{actions:u(({unselectAll:t,selections:l})=>[f("div",ge,[r(s(V),{variant:"ghost",onClick:_=>j(l,t)},{default:u(()=>[r(s(ae),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])):(o(),g(le,{key:1,type:"Programming Exercise Submissions"})),s(i).data&&s(i).hasNextPage?(o(),c("div",pe,[r(s(V),{onClick:a[3]||(a[3]=t=>s(i).next())},{default:u(()=>[M(y(e.__("Load More")),1)]),_:1})])):v("",!0)])],64)}}});export{$e as default};
//# sourceMappingURL=ProgrammingExerciseSubmissions-Bck45AH-.js.map
