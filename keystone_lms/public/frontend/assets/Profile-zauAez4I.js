import{i as B,x as I,A,g as O,o as d,a as h,b as o,t as c,u as t,e as n,w as u,p as U,k as P,f as v,s as z,c as j,L as T,l as b,R as J,N as C,a9 as K,S as Q,a2 as X,D as Z,v as ee,a7 as te,B as E,av as ae,T as le,b$ as se,bb as oe,F as D,r as ie,aa as re,c0 as ne,c1 as de,ao as ue,y as me,bz as ce,b2 as fe,c2 as _e,n as N,c3 as R,c4 as pe,_ as ge,c5 as ve,c6 as be,c7 as he,a8 as ke,aF as ye,E as xe,z as we,q as $e}from"./index-H4DTv6Le.js";import{_ as Pe}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";import{T as Ve}from"./TabButtons-BM55rf33.js";const Ce={class:"bg-surface-white w-full h-full"},Ue={class:"w-fit mx-auto mt-56 text-center p-4"},Se={class:"text-3xl font-semibold text-ink-gray-5 pb-4 mb-2 border-b"},Te={key:0,class:"px-5 py-3"},Ee={class:"text-ink-gray-5"},je={class:"px-5 py-3"},Le={class:"text-ink-gray-5"},Me={__name:"NoPermission",setup(V){const w=B("$user"),{brand:y}=I(),f=()=>{window.location.href="/login"};return A(()=>({title:__("Not Permitted"),icon:y.favicon})),(m,p)=>{const a=O("router-link");return d(),h("div",Ce,[o("div",Ue,[o("div",Se,c(m.__("Not Permitted")),1),t(w).data?(d(),h("div",Te,[o("div",Ee,c(m.__("You do not have permission to access this page.")),1),n(a,{to:{name:"Courses"}},{default:u(()=>[n(t(U),{variant:"solid",class:"mt-2 w-full"},{default:u(()=>[P(c(m.__("Checkout Courses")),1)]),_:1})]),_:1})])):v("",!0),o("div",je,[o("div",Le,c(m.__("You are not permitted to access this page.")),1),n(t(U),{onClick:p[0]||(p[0]=_=>f()),class:"mt-4 w-full",variant:"solid"},{default:u(()=>[P(c(m.__("Login")),1)]),_:1})])])])}}},ze={class:"flex items-center justify-between mb-5"},Ne={class:"text-2xl font-semibold leading-6 text-ink-gray-9"},Re={class:"space-x-2"},Be={class:"pb-5 float-right"},Ie={class:"text-base"},Ae={class:"grid grid-cols-2 gap-10"},Oe={class:"space-y-4"},De={class:"space-y-4"},Fe={class:"space-y-4"},He={class:"mb-1.5 text-sm text-ink-gray-5"},qe={__name:"EditProfile",props:ee({profile:{type:Object,required:!0}},{modelValue:{},modelModifiers:{},reloadProfile:{},reloadProfileModifiers:{}}),emits:["update:modelValue","update:reloadProfile"],setup(V){const w=z(V,"modelValue"),y=z(V,"reloadProfile"),f=E(!1),m=E(!1),p=V,a=te({first_name:"",last_name:"",headline:"",bio:"",image:"",open_to:"",linkedin:"",github:"",twitter:""}),_=j({url:"frappe.client.set_value",makeParams(l){return{doctype:"User",name:p.profile.data.name,fieldname:{user_image:a.image||null,...a}}},onSuccess(l){p.profile.data=l}}),k=()=>{a.bio=ae(a.bio),_.submit({},{onSuccess(){w.value=!1,y.value.reload(),f.value&&(f.value=!1,window.location.reload())},onError(l){var e;le.error(((e=l.messages)==null?void 0:e[0])||l)}})};return T(()=>a,l=>{if(!p.profile.data)return;let e=Object.keys(l);e.splice(e.indexOf("image"),1);for(let $ of e)if(l[$]!==p.profile.data[$]){m.value=!0;return}if(a.image!==p.profile.data.user_image){m.value=!0;return}m.value=!1},{deep:!0}),T(()=>p.profile.data,l=>{l&&(a.first_name=l.first_name,a.last_name=l.last_name,a.headline=l.headline,a.language=l.language,a.bio=l.bio,a.open_to=l.open_to,a.linkedin=l.linkedin,a.github=l.github,a.twitter=l.twitter,a.image=l.user_image,m.value=!1)}),T(()=>a.language,()=>{a.language!==p.profile.data.language&&(f.value=!0)}),(l,e)=>{const $=J;return d(),b(t(Z),{modelValue:w.value,"onUpdate:modelValue":e[11]||(e[11]=r=>w.value=r),options:{size:"3xl"}},{"body-header":u(()=>[o("div",ze,[o("div",Ne,c(l.__("Edit Profile")),1),o("div",Re,[m.value?(d(),b(t(X),{key:0,theme:"orange"},{default:u(()=>[P(c(l.__("Not Saved")),1)]),_:1})):v("",!0),o("div",Be,[n(t(U),{variant:"solid",onClick:e[0]||(e[0]=r=>k())},{default:u(()=>[P(c(l.__("Save")),1)]),_:1})])])])]),"body-content":u(()=>[o("div",Ie,[o("div",Ae,[o("div",Oe,[o("div",De,[n($,{modelValue:a.image,"onUpdate:modelValue":e[1]||(e[1]=r=>a.image=r),label:l.__("Profile Image"),required:!0,shape:"circle"},null,8,["modelValue","label"]),n(t(C),{modelValue:a.first_name,"onUpdate:modelValue":e[2]||(e[2]=r=>a.first_name=r),label:l.__("First Name")},null,8,["modelValue","label"]),n(t(C),{modelValue:a.last_name,"onUpdate:modelValue":e[3]||(e[3]=r=>a.last_name=r),label:l.__("Last Name")},null,8,["modelValue","label"]),n(t(C),{modelValue:a.headline,"onUpdate:modelValue":e[4]||(e[4]=r=>a.headline=r),label:l.__("Headline")},null,8,["modelValue","label"]),n(t(C),{modelValue:a.linkedin,"onUpdate:modelValue":e[5]||(e[5]=r=>a.linkedin=r),label:l.__("LinkedIn ID")},null,8,["modelValue","label"]),n(t(C),{modelValue:a.github,"onUpdate:modelValue":e[6]||(e[6]=r=>a.github=r),label:l.__("GitHub ID")},null,8,["modelValue","label"]),n(t(C),{modelValue:a.twitter,"onUpdate:modelValue":e[7]||(e[7]=r=>a.twitter=r),label:l.__("Twitter ID")},null,8,["modelValue","label"])])]),o("div",Fe,[n(t(C),{modelValue:a.open_to,"onUpdate:modelValue":e[8]||(e[8]=r=>a.open_to=r),type:"select",options:[" ","Work","Hiring"],label:l.__("Open to"),placeholder:l.__("Looking for new work or hiring talent?")},null,8,["modelValue","label","placeholder"]),n(K,{label:l.__("Language"),modelValue:a.language,"onUpdate:modelValue":e[9]||(e[9]=r=>a.language=r),doctype:"Language"},null,8,["label","modelValue"]),o("div",null,[o("div",He,c(l.__("Bio")),1),n(t(Q),{fixedMenu:!0,onChange:e[10]||(e[10]=r=>a.bio=r),content:a.bio,rows:15,editorClass:"prose-sm py-2 px-2 min-h-[280px] border-outline-gray-2 hover:border-outline-gray-3 rounded-b-md bg-surface-gray-3"},null,8,["content"])])])])])]),_:1},8,["modelValue"])}}},We={class:"absolute left-1/2 mt-3 w-96 max-w-lg -translate-x-1/2 transform rounded-lg bg-surface-white px-4 sm:px-0 lg:max-w-3xl"},Ge={class:"overflow-hidden rounded-lg p-3 shadow-2xl ring-1 ring-black ring-opacity-5"},Ye={class:"flex items-center justify-center space-x-2"},Je={class:""},Ke={class:"relative mt-2 grid w-[25.5rem] gap-2 bg-surface-white lg:grid-cols-2"},Qe=["onClick"],Xe=["src"],Ze={key:0,class:"mt-2 text-center text-sm text-ink-gray-4"},et={class:"underline",target:"_blank",href:"https://unsplash.com"},tt={__name:"EditCoverImage",emits:["select"],setup(V,{emit:w}){const y=E(null),f=w,m=j({url:"lms.lms.api.get_unsplash_photos",makeParams:()=>({keyword:y.value}),auto:!0,debounce:500});T(()=>y.value,()=>{m.reload()});const p=_=>{f("select",_.file_url)},a=_=>{let k=_.name.split(".").pop().toLowerCase();if(!["jpg","jpeg","png"].includes(k))return"Only image file is allowed."};return(_,k)=>(d(),b(t(ue),{transition:"default"},{target:u(({isOpen:l,togglePopover:e})=>[re(_.$slots,"default",ne(de({isOpen:l,togglePopover:e})))]),body:u(()=>[o("div",We,[o("div",Ge,[o("div",Ye,[n(t(se),{type:"text",placeholder:"search by keyword",modelValue:y.value,"onUpdate:modelValue":k[0]||(k[0]=l=>y.value=l),debounce:300,class:"flex-1"},null,8,["modelValue"]),n(t(oe),{fileTypes:["image/*"],validateFile:a,onSuccess:k[1]||(k[1]=l=>p(l))},{default:u(({file:l,progress:e,uploading:$,openFileSelector:r})=>[o("div",Je,[n(t(U),{onClick:r,loading:$},{default:u(()=>[P(c($?`Uploading ${e}%`:"Upload Image"),1)]),_:2},1032,["onClick","loading"])])]),_:1})]),o("div",Ke,[(d(!0),h(D,null,ie(t(m).data,l=>(d(),h("button",{key:l.id,class:"h-[50px] w-[200px] overflow-hidden rounded hover:opacity-80",onClick:e=>_.$emit("select",l.urls.raw)},[o("img",{src:l.urls.raw+"&w=200&h=50&fit=crop&crop=entropy,faces,focalpoint"},null,8,Xe)],8,Qe))),128))]),t(m).data?(d(),h("div",Ze,[P(c(_.__("Image search powered by"))+" ",1),o("a",et,c(_.__("Unsplash")),1)])):v("",!0)])])]),_:3}))}},at={key:1},lt={class:"sticky group top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},st={class:"group relative h-[130px] w-full"},ot=["src"],it={key:2,class:"absolute bottom-[30%] md:bottom-0 left-[50%] mb-4 flex -translate-x-1/2 space-x-2 opacity-0 transition-opacity focus-within:opacity-100 group-hover:opacity-100"},rt={class:"mx-auto -mt-10 md:-mt-4 max-w-4xl translate-x-0 px-5"},nt={class:"flex flex-col md:flex-row items-center"},dt={class:"relative"},ut=["src"],mt={key:1,class:"flex items-center justify-center h-[100px] w-[100px] rounded-full border-4 border-white bg-surface-gray-2 text-3xl font-semibold text-ink-gray-7"},ct={class:"absolute bottom-3 right-1 p-0.5 bg-surface-white rounded-full"},ft={class:"ml-6 mt-5"},_t={class:"text-3xl font-semibold text-ink-gray-9"},pt={class:"text-base text-ink-gray-7 mt-1"},gt={class:"flex items-center space-x-4 mt-2"},vt={class:"mb-4 mt-10"},xt={__name:"Profile",props:{username:{type:String,required:!0}},setup(V){const{user:w,brand:y}=I(),f=B("$user"),m=ye(),p=$e(),a=E(""),_=E(!1),k=window.read_only_mode,l=V;me(()=>{f.data&&e.reload(),r()});const e=j({url:"lms.lms.api.get_profile_details",makeParams(){return{username:l.username}}}),$=j({url:"frappe.client.set_value",makeParams(i){var s;return{doctype:"User",name:(s=e.data)==null?void 0:s.name,fieldname:"cover_image",value:i.url}},onSuccess(){e.reload()}}),r=()=>{let i=m.path.split("/");["certificates","roles","slots","schedule"].forEach(x=>{i.includes(x)&&(a.value=ce(x))}),a.value||(a.value="About")};fe(()=>{if(a.value){let i={About:{name:"ProfileAbout"},Certificates:{name:"ProfileCertificates"},Roles:{name:"ProfileRoles"},Slots:{name:"ProfileEvaluator"},Schedule:{name:"ProfileEvaluationSchedule"}}[a.value];p.push(i)}}),T(()=>l.username,()=>{e.reload()});const F=()=>{_.value=!0},L=()=>{var i,s;return((i=f.data)==null?void 0:i.email)===((s=e.data)==null?void 0:s.name)},H=()=>{var i,s;return((i=f.data)==null?void 0:i.is_evaluator)||((s=f.data)==null?void 0:s.is_moderator)},q=()=>{var i,s,x,S;return((s=(i=e.data)==null?void 0:i.roles)==null?void 0:s.includes("Batch Evaluator"))||((S=(x=e.data)==null?void 0:x.roles)==null?void 0:S.includes("Moderator"))},W=()=>{var s;let i=[{label:__("About"),value:"About"},{label:__("Certificates"),value:"Certificates"}];return(s=f.data)!=null&&s.is_moderator&&i.push({label:__("Roles"),value:"Roles"}),H()&&q()&&(i.push({label:__("Slots"),value:"Slots"}),i.push({label:__("Schedule"),value:"Schedule"})),i},G=()=>{we("frappe.sessions.clear").then(()=>{f.reload().then(()=>{e.reload()})})},M=i=>{window.open(i,"_blank")},Y=xe(()=>{var s,x;return[{label:__("People")},{label:(s=e.data)==null?void 0:s.full_name,route:{name:"Profile",params:{username:(x=w.doc)==null?void 0:x.username}}}]});return A(()=>{var i;return{title:(i=e.data)==null?void 0:i.full_name,icon:y.favicon}}),(i,s)=>{var S;const x=O("router-view");return d(),h(D,null,[t(f).data?t(e).data?(d(),h("div",at,[o("header",lt,[n(t(Pe),{class:"h-7",items:Y.value},null,8,["items"]),L()?(d(),b(t(U),{key:0,class:"invisible group-hover:visible"},{icon:u(()=>[n(t(_e),{class:"w-4 h-4 stroke-1.5 text-ink-gray-7",onClick:s[0]||(s[0]=g=>G())})]),_:1})):v("",!0)]),o("div",st,[t(e).data.cover_image?(d(),h("img",{key:0,src:t(e).data.cover_image,class:"h-[130px] w-full object-cover object-center"},null,8,ot)):(d(),h("div",{key:1,class:N([{"bg-surface-gray-2":!t(e).data.cover_image},"h-[130px] w-full"])},null,2)),L()?(d(),h("div",it,[n(tt,{onSelect:s[1]||(s[1]=g=>t($).submit({url:g}))},{default:u(({togglePopover:g})=>[t(k)?v("",!0):(d(),b(t(U),{key:0,variant:"outline",onClick:bt=>g()},{prefix:u(()=>[n(t(R),{class:"w-4 h-4 stroke-1.5 text-ink-gray-7"})]),default:u(()=>[P(" "+c(i.__("Edit")),1)]),_:1},8,["onClick"]))]),_:1})])):v("",!0)]),o("div",rt,[o("div",nt,[o("div",null,[o("div",dt,[t(e).data.user_image?(d(),h("img",{key:0,src:t(e).data.user_image,class:"object-cover h-[100px] w-[100px] rounded-full border-4 border-white object-cover"},null,8,ut)):(d(),h("div",mt,c(t(e).data.full_name.charAt(0).toUpperCase()),1)),t(e).data.open_to?(d(),b(t(ge),{key:2,text:t(e).data.open_to==="Work"?i.__("Open to Work"):i.__("Hiring"),placement:"right"},{default:u(()=>[o("div",ct,[o("div",{class:N(["rounded-full w-fit",t(e).data.open_to==="Work"?"bg-surface-green-3":"bg-purple-500"])},[n(t(pe),{class:"text-ink-white size-5"})],2)])]),_:1},8,["text"])):v("",!0)])]),o("div",ft,[o("h2",_t,c(t(e).data.full_name),1),o("div",pt,c(t(e).data.headline),1),o("div",gt,[t(e).data.twitter?(d(),b(t(ve),{key:0,class:"size-4 text-ink-gray-5 cursor-pointer",onClick:s[2]||(s[2]=g=>M(t(e).data.twitter))})):v("",!0),t(e).data.linkedin?(d(),b(t(be),{key:1,class:"size-4 text-ink-gray-5 cursor-pointer",onClick:s[3]||(s[3]=g=>M(t(e).data.linkedin))})):v("",!0),t(e).data.github?(d(),b(t(he),{key:2,class:"size-4 text-ink-gray-5 cursor-pointer",onClick:s[4]||(s[4]=g=>M(t(e).data.github))})):v("",!0)])]),L()&&!t(k)?(d(),b(t(U),{key:0,class:"mt-3 sm:mt-0 md:ml-auto",onClick:s[5]||(s[5]=g=>F())},{prefix:u(()=>[n(t(R),{class:"w-4 h-4 stroke-1.5 text-ink-gray-7"})]),default:u(()=>[P(" "+c(i.__("Edit Profile")),1)]),_:1})):v("",!0)]),o("div",vt,[n(t(Ve),{class:"inline-block",buttons:W(),modelValue:a.value,"onUpdate:modelValue":s[6]||(s[6]=g=>a.value=g)},null,8,["buttons","modelValue"])]),(d(),b(x,{profile:t(e),key:(S=t(e).data)==null?void 0:S.name},null,8,["profile"]))])])):v("",!0):(d(),b(Me,{key:0})),n(qe,{modelValue:_.value,"onUpdate:modelValue":s[7]||(s[7]=g=>_.value=g),reloadProfile:t(e),"onUpdate:reloadProfile":s[8]||(s[8]=g=>ke(e)?e.value=g:null),profile:t(e)},null,8,["modelValue","reloadProfile","profile"])],64)}}};export{xt as default};
//# sourceMappingURL=Profile-zauAez4I.js.map
