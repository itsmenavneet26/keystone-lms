{"version":3,"file":"DonutChart.vue_vue_type_script_setup_true_lang-a2xPBmC8.js","sources":["../../../../frontend/node_modules/frappe-ui/src/components/Charts/donutChartOptions.ts","../../../../frontend/node_modules/frappe-ui/src/components/Charts/DonutChart.vue"],"sourcesContent":["import { getTitleOptions } from './eChartOptions'\nimport { formatValue } from './helpers'\nimport { DonutChartConfig } from './types'\n\nexport default function useDonutChartOptions(config: DonutChartConfig) {\n  let data = config.data || []\n\n  data = data.sort((a, b) => {\n    const aValue = a[config.valueColumn]\n    const bValue = b[config.valueColumn]\n    if (aValue === bValue) {\n      return 0\n    }\n    return aValue > bValue ? -1 : 1\n  })\n\n  const labels = data.map((row) => row[config.categoryColumn])\n  const values = data.map((row) => row[config.valueColumn])\n  const total = values.reduce((acc, value) => {\n    return isNaN(value) ? acc : acc + value\n  }, 0)\n\n  let radius = ['40%', '70%']\n  let center = ['50%', '48%']\n\n  if (config.subtitle) {\n    radius = ['40%', '70%']\n    center = ['50%', '50%']\n  }\n\n  if (config.showInlineLabels) {\n    center = ['50%', '50%']\n  }\n\n  // legend position\n  let orient = 'horizontal'\n  let bottom = 0\n  let left = 'center'\n  // let padding = [30, 30, 10, 30]\n  let padding = [0, 10, 10, 10]\n\n  return {\n    animation: true,\n    animationDuration: 700,\n    color: config.colors,\n    textStyle: { fontFamily: ['InterVar', 'sans-serif'] },\n    title: getTitleOptions(config.title, config.subtitle),\n    dataset: {\n      source: [\n        [config.categoryColumn, config.valueColumn],\n        ...data.map((r) => [r[config.categoryColumn], r[config.valueColumn]]),\n      ],\n    },\n    series: [\n      {\n        type: 'pie',\n        name: config.categoryColumn,\n        center,\n        radius,\n        labelLine: {\n          show: config.showInlineLabels,\n          lineStyle: {\n            width: 2,\n          },\n          length: 10,\n          length2: 20,\n          smooth: true,\n        },\n        label: {\n          show: config.showInlineLabels,\n          formatter: ({ value, name }: any) => {\n            const percentage = total > 0 ? (value[1] / total) * 100 : 0\n            return `${name} (${percentage.toFixed(0)}%)`\n          },\n        },\n        emphasis: { scaleSize: 5 },\n      },\n    ],\n    legend: !config.showInlineLabels\n      ? {\n          // top,\n          left: left,\n          bottom: bottom,\n          padding: padding,\n          orient: orient,\n          show: true,\n          type: 'scroll',\n          itemGap: 12,\n          formatter: function (name: string) {\n            const labelIndex = labels.indexOf(name)\n            const percentage =\n              total > 0 ? (values[labelIndex] / total) * 100 : 0\n            return `${name} (${percentage.toFixed(0)}%)`\n          },\n          textStyle: {\n            padding: [0, 0, 0, -5],\n            color: 'var(--ink-gray-8)',\n          },\n          icon: 'circle',\n          pageIcons: {\n            horizontal: [\n              'M 17 3 h 2 c 0.386 0 0.738 0.223 0.904 0.572 s 0.115 0.762 -0.13 1.062 L 11.292 15 l 8.482 10.367 c 0.245 0.299 0.295 0.712 0.13 1.062 S 19.386 27 19 27 h -2 c -0.3 0 -0.584 -0.135 -0.774 -0.367 l -9 -11 c -0.301 -0.369 -0.301 -0.898 0 -1.267 l 9 -11 C 16.416 3.135 16.7 3 17 3 Z',\n              'M 12 27 h -2 c -0.386 0 -0.738 -0.223 -0.904 -0.572 s -0.115 -0.762 0.13 -1.062 L 17.708 15 L 9.226 4.633 c -0.245 -0.299 -0.295 -0.712 -0.13 -1.062 S 9.614 3 10 3 h 2 c 0.3 0 0.584 0.135 0.774 0.367 l 9 11 c 0.301 0.369 0.301 0.898 0 1.267 l -9 11 C 12.584 26.865 12.3 27 12 27 Z',\n            ],\n          },\n          pageIconColor: 'var(--ink-gray-6)',\n          pageInactiveColor: 'var(--ink-gray-4)',\n          pageIconSize: 10,\n          pageTextStyle: {\n            color: 'var(--ink-gray-6)',\n          },\n          animationDurationUpdate: 300,\n        }\n      : null,\n    tooltip: {\n      trigger: 'item',\n      confine: true,\n      appendToBody: false,\n      formatter: function (params: any) {\n        const p = params as any\n        const value = p.value[1]\n        const percentage = total > 0 ? (value / total) * 100 : 0\n        const formatted = isNaN(value) ? value : formatValue(value, 1, true)\n        const formattedPercentage = percentage.toFixed(0)\n        return `\n          <div class=\"flex items-center justify-between gap-5\">\n            <div>${p.name}</div>\n            <div class=\"font-bold\">\n              ${formatted} (${formattedPercentage}%)\n            </div>\n          </div>\n        `\n      },\n    },\n  }\n}\n","<template>\n  <ECharts :options=\"options\" :error=\"error\" />\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from 'vue'\nimport useDonutChartOptions from './donutChartOptions'\nimport ECharts from './ECharts.vue'\nimport { DonutChartConfig } from './types'\n\nconst props = defineProps<{ config: DonutChartConfig }>()\n\nconst error = ref('')\nconst options = computed(() => {\n  try {\n    return useDonutChartOptions(props.config)\n  } catch (e: any) {\n    error.value = e.message\n    return {}\n  }\n})\n</script>\n"],"names":["useDonutChartOptions","config","data","a","b","aValue","bValue","labels","row","values","total","acc","value","radius","center","orient","bottom","left","padding","getTitleOptions","r","name","percentage","labelIndex","params","p","formatted","formatValue","formattedPercentage","props","__props","error","ref","options","computed","e","_createBlock","ECharts"],"mappings":"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","x_google_ignoreList":[0,1]}