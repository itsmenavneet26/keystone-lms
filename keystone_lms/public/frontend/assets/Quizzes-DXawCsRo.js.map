{"version":3,"file":"Quizzes-DXawCsRo.js","sources":["../../../../frontend/src/pages/Quizzes.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<Button v-if=\"!readOnlyMode\" variant=\"solid\" @click=\"showForm = true\">\n\t\t\t<template #prefix>\n\t\t\t\t<Plus class=\"w-4 h-4\" />\n\t\t\t</template>\n\t\t\t{{ __('Create') }}\n\t\t</Button>\n\t</header>\n\t<div class=\"py-5 mx-5\">\n\t\t<div class=\"flex items-center justify-between mb-4\">\n\t\t\t<div class=\"text-lg font-semibold text-ink-gray-7\">\n\t\t\t\t{{\n\t\t\t\t\tquizzes.data?.length\n\t\t\t\t\t\t? __('{0} Quizzes').format(quizzes.data.length)\n\t\t\t\t\t\t: __('No Quizzes')\n\t\t\t\t}}\n\t\t\t</div>\n\t\t\t<FormControl v-model=\"search\" type=\"text\" placeholder=\"Search\">\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<FeatherIcon name=\"search\" class=\"size-4 text-ink-gray-5\" />\n\t\t\t\t</template>\n\t\t\t</FormControl>\n\t\t</div>\n\t\t<ListView\n\t\t\tv-if=\"quizzes.data?.length\"\n\t\t\t:columns=\"quizColumns\"\n\t\t\t:rows=\"quizzes.data\"\n\t\t\trow-key=\"name\"\n\t\t\t:options=\"{ showTooltip: false, selectable: true }\"\n\t\t>\n\t\t\t<ListHeader\n\t\t\t\tclass=\"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2\"\n\t\t\t>\n\t\t\t\t<ListHeaderItem :item=\"item\" v-for=\"item in quizColumns\">\n\t\t\t\t\t<template #prefix=\"{ item }\">\n\t\t\t\t\t\t<FeatherIcon :name=\"item.icon?.toString()\" class=\"h-4 w-4\" />\n\t\t\t\t\t</template>\n\t\t\t\t</ListHeaderItem>\n\t\t\t</ListHeader>\n\t\t\t<ListRows>\n\t\t\t\t<router-link\n\t\t\t\t\tv-for=\"row in quizzes.data\"\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'QuizForm',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tquizID: row.name,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<ListRow :row=\"row\">\n\t\t\t\t\t\t<template #default=\"{ column, item }\">\n\t\t\t\t\t\t\t<ListRowItem :item=\"row[column.key]\" :align=\"column.align\">\n\t\t\t\t\t\t\t\t<div v-if=\"column.key == 'show_answers'\">\n\t\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t\tv-model=\"row[column.key]\"\n\t\t\t\t\t\t\t\t\t\t:disabled=\"true\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-else-if=\"column.key == 'modified'\"\n\t\t\t\t\t\t\t\t\tclass=\"text-xs text-ink-gray-5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t\t\t\t{{ row[column.key] }}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</ListRowItem>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</ListRow>\n\t\t\t\t</router-link>\n\t\t\t</ListRows>\n\t\t\t<ListSelectBanner>\n\t\t\t\t<template #actions=\"{ unselectAll, selections }\">\n\t\t\t\t\t<div class=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t@click=\"deleteQuiz(selections, unselectAll)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<FeatherIcon name=\"trash-2\" class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</ListSelectBanner>\n\t\t</ListView>\n\t\t<EmptyState v-else type=\"Quizzes\" />\n\t\t<div v-if=\"quizzes.hasNextPage\" class=\"flex justify-center my-5\">\n\t\t\t<Button @click=\"quizzes.next()\">\n\t\t\t\t{{ __('Load More') }}\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n\t<Dialog\n\t\tv-model=\"showForm\"\n\t\t:options=\"{\n\t\t\ttitle: __('Create a Quiz'),\n\t\t\tsize: 'sm',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: __('Save'),\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tonClick({ close }) {\n\t\t\t\t\t\tinsertQuiz(close)\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t}\"\n\t>\n\t\t<template #body-content>\n\t\t\t<FormControl\n\t\t\t\tv-model=\"title\"\n\t\t\t\t:label=\"__('Title')\"\n\t\t\t\ttype=\"text\"\n\t\t\t\t@keydown.enter=\"insertQuiz(() => (showForm = false))\"\n\t\t\t/>\n\t\t</template>\n\t</Dialog>\n</template>\n<script setup>\nimport {\n\tBreadcrumbs,\n\tButton,\n\tcreateListResource,\n\tDialog,\n\tFeatherIcon,\n\tFormControl,\n\tListView,\n\tListRows,\n\tListRow,\n\tListRowItem,\n\tListHeader,\n\tListHeaderItem,\n\tListSelectBanner,\n\ttoast,\n\tusePageMeta,\n} from 'frappe-ui'\nimport { useRouter, useRoute } from 'vue-router'\nimport { computed, inject, onMounted, ref, watch } from 'vue'\nimport { Plus } from 'lucide-vue-next'\nimport { sessionStore } from '@/stores/session'\nimport { escapeHTML } from '@/utils'\nimport { useTelemetry } from 'frappe-ui/frappe'\nimport EmptyState from '@/components/EmptyState.vue'\n\nconst { brand } = sessionStore()\nconst { capture } = useTelemetry()\nconst user = inject('$user')\nconst dayjs = inject('$dayjs')\nconst router = useRouter()\nconst route = useRoute()\nconst search = ref('')\nconst readOnlyMode = window.read_only_mode\nconst quizFilters = ref({})\nconst showForm = ref(false)\nconst title = ref('')\n\nonMounted(() => {\n\tif (!user.data?.is_moderator && !user.data?.is_instructor) {\n\t\trouter.push({ name: 'Courses' })\n\t} else if (!user.data?.is_moderator) {\n\t\tquizFilters.value['owner'] = user.data?.name\n\t}\n\tif (route.query.new === 'true') {\n\t\tshowForm.value = true\n\t}\n})\n\nwatch(search, () => {\n\tquizFilters.value['title'] = ['like', `%${search.value}%`]\n\tquizzes.update({\n\t\tfilters: quizFilters.value,\n\t})\n\tquizzes.reload()\n})\n\nconst quizzes = createListResource({\n\tdoctype: 'LMS Quiz',\n\tfilters: quizFilters,\n\tfields: [\n\t\t'name',\n\t\t'title',\n\t\t'passing_percentage',\n\t\t'total_marks',\n\t\t'show_answers',\n\t\t'max_attempts',\n\t\t'modified',\n\t],\n\tauto: true,\n\tcache: ['quizzes', user.data?.name],\n\torderBy: 'modified desc',\n\ttransform(data) {\n\t\treturn data.map((quiz) => {\n\t\t\treturn {\n\t\t\t\t...quiz,\n\t\t\t\tmodified: dayjs(quiz.modified).fromNow(),\n\t\t\t}\n\t\t})\n\t},\n})\n\nconst validateTitle = () => {\n\ttitle.value = escapeHTML(title.value.trim())\n}\n\nconst insertQuiz = (close) => {\n\tvalidateTitle()\n\tquizzes.insert.submit(\n\t\t{\n\t\t\ttitle: title.value,\n\t\t},\n\t\t{\n\t\t\tonSuccess(data) {\n\t\t\t\ttoast.success(__('Quiz created successfully'))\n\t\t\t\tclose()\n\t\t\t\ttitle.value = ''\n\t\t\t\tcapture('quiz_created')\n\t\t\t\trouter.push({\n\t\t\t\t\tname: 'QuizForm',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tquizID: data.name,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t},\n\t\t\tonError(error) {\n\t\t\t\ttoast.error(__('Error creating quiz: {0}', error.message))\n\t\t\t},\n\t\t}\n\t)\n}\n\nconst deleteQuiz = (selections, unselectAll) => {\n\tArray.from(selections).forEach(async (quizName) => {\n\t\tawait quizzes.delete.submit(quizName)\n\t})\n\tunselectAll()\n\ttoast.success(__('Quizzes deleted successfully'))\n}\n\nconst quizColumns = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('Title'),\n\t\t\tkey: 'title',\n\t\t\twidth: 2,\n\t\t\ticon: 'file-text',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Total Marks'),\n\t\t\tkey: 'total_marks',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t\ticon: 'hash',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Passing Percentage'),\n\t\t\tkey: 'passing_percentage',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t\ticon: 'percent',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Max Attempts'),\n\t\t\tkey: 'max_attempts',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t\ticon: 'repeat',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Show Answers'),\n\t\t\tkey: 'show_answers',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t\ticon: 'eye',\n\t\t},\n\t\t{\n\t\t\tlabel: __('Modified'),\n\t\t\tkey: 'modified',\n\t\t\twidth: 1,\n\t\t\talign: 'center',\n\t\t\ticon: 'clock',\n\t\t},\n\t]\n})\n\nconst breadcrumbs = computed(() => {\n\treturn [\n\t\t{\n\t\t\tlabel: __('Quizzes'),\n\t\t\troute: {\n\t\t\t\tname: 'Quizzes',\n\t\t\t},\n\t\t},\n\t]\n})\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: __('Quizzes'),\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n"],"names":["brand","sessionStore","capture","useTelemetry","user","inject","dayjs","router","useRouter","route","useRoute","search","ref","readOnlyMode","quizFilters","showForm","title","onMounted","_a","_b","_c","_d","watch","quizzes","createListResource","data","quiz","validateTitle","escapeHTML","insertQuiz","close","toast","error","deleteQuiz","selections","unselectAll","quizName","quizColumns","computed","breadcrumbs","usePageMeta","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_createBlock","Button","Plus","_createTextVNode","__","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","FormControl","$event","FeatherIcon","ListView","ListHeader","_createElementBlock","_Fragment","_renderList","item","ListHeaderItem","_withCtx","ListRows","_openBlock","row","_component_router_link","ListRow","column","ListRowItem","_hoisted_5","_hoisted_6","_hoisted_7","ListSelectBanner","_hoisted_8","EmptyState","_hoisted_9","_cache","Dialog","_withKeys"],"mappings":"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"}