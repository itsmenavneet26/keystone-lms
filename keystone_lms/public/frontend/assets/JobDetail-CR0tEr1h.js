import{s as N,i as J,c as C,o as u,l as f,w as o,b as i,t as n,a as g,e as l,u as e,bb as H,p as v,k as m,cH as O,bc as q,bd as W,D as Y,v as I,B as E,T as R,x as K,A as G,f as y,bo as Q,cI as X,cJ as Z,ad as ee,a2 as $,cK as ae,cL as te,cM as se,cN as oe,a8 as ie,E as le,g as ne}from"./index-H4DTv6Le.js";import{_ as re}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";const de={class:"flex flex-col gap-4 text-base"},pe={class:"text-ink-gray-9"},ce={key:0},ue={class:""},me={key:1,class:"flex items-center"},_e={class:"border rounded-md p-2 mr-2"},be={class:"flex flex-col"},fe={class:"text-ink-gray-9"},ye={class:"text-sm text-ink-gray-4 mt-1"},ve={__name:"JobApplicationModal",props:I({job:{type:String,required:!0}},{modelValue:{},modelModifiers:{},application:{},applicationModifiers:{}}),emits:["update:modelValue","update:application"],setup(k){const d=E(null),z=N(k,"modelValue"),V=J("$user"),x=N(k,"application"),M=k,S=p=>{if(p.name.split(".").pop().toLowerCase()!="pdf")return"Only PDF file is allowed"},t=C({url:"frappe.client.insert",makeParams(p){var c,r;return{doc:{doctype:"LMS Job Application",user:(c=V.data)==null?void 0:c.name,resume:(r=d.value)==null?void 0:r.file_url,job:M.job}}}}),_=p=>{t.submit({},{validate(){if(!d.value)return"Please upload your resume"},onSuccess(){R.success("Your application has been submitted successfully"),x.value.reload(),p()},onError(c){var r;R.error(((r=c.messages)==null?void 0:r[0])||c)}})};return(p,c)=>(u(),f(e(Y),{modelValue:z.value,"onUpdate:modelValue":c[1]||(c[1]=r=>z.value=r),class:"text-base",options:{title:p.__("Apply for this job"),size:"lg",actions:[{label:"Submit",variant:"solid",onClick:r=>{_(r)}}]}},{"body-content":o(()=>[i("div",de,[i("p",pe,n(p.__("Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.")),1),d.value?(u(),g("div",me,[i("div",_e,[l(e(q),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),i("div",be,[i("span",fe,n(d.value.file_name),1),i("span",ye,n(e(W)(d.value.file_size)),1)])])):(u(),g("div",ce,[l(e(H),{fileTypes:[".pdf"],validateFile:S,uploadArgs:{private:1},onSuccess:c[0]||(c[0]=r=>{d.value=r})},{default:o(({file:r,progress:A,uploading:h,openFileSelector:s})=>[i("div",ue,[l(e(v),{onClick:s,loading:h},{prefix:o(()=>[l(e(O),{class:"size-4 stroke-1.5"})]),default:o(()=>[m(" "+n(h?`Uploading ${A}%`:"Upload your resume"),1)]),_:2},1032,["onClick","loading"])])]),_:1})]))])]),_:1},8,["modelValue","options"]))}},ge={class:""},ke={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},xe={key:0,class:"flex items-center space-x-2"},he={key:1},we={key:0,class:"max-w-3xl mx-auto pt-5"},je={class:"p-4"},$e={class:"space-y-5 mb-12"},ze={class:"flex"},Me=["src","alt"],Se={class:""},Ae={class:"text-2xl text-ink-gray-9 font-semibold mb-1"},Ce={class:"text-sm text-ink-gray-5 font-semibold"},Ve={class:"space-x-2"},Je={class:"flex items-center justify-between"},Ue=["innerHTML"],Pe={__name:"JobDetail",props:{job:{type:String,required:!0}},setup(k){const d=J("$user"),z=J("$dayjs"),{brand:V}=K(),x=E(!1),M=window.read_only_mode,S=k,t=C({url:"lms.lms.api.get_job_details",params:{job:S.job},cache:["job",S.job],auto:!0,onSuccess:s=>{var a;(a=d.data)!=null&&a.name&&(_.submit(),p.submit())}}),_=C({url:"frappe.client.get_list",makeParams(s){var a,w;return{doctype:"LMS Job Application",filters:{job:(a=t.data)==null?void 0:a.name,user:(w=d.data)==null?void 0:w.name}}}}),p=C({url:"frappe.client.get_count",makeParams(s){var a;return{doctype:"LMS Job Application",filters:{job:(a=t.data)==null?void 0:a.name}}}}),c=()=>{x.value=!0},r=s=>{window.location.href=`/login?redirect-to=/job-openings/${s}`},A=s=>{window.open(s,"_blank")},h=le(()=>{var s,a;return!((s=d.data)!=null&&s.name)||!t.data?!1:d.data.name===t.data.owner||((a=d.data)==null?void 0:a.is_moderator)});return G(()=>{var s;return{title:(s=t.data)==null?void 0:s.job_title,icon:V.favicon}}),(s,a)=>{var U,L,T,P,B,D,F;const w=ne("router-link");return u(),g("div",ge,[i("header",ke,[l(e(re),{class:"h-7",items:[{label:s.__("Jobs"),route:{name:"Jobs"}},{label:(U=e(t).data)==null?void 0:U.job_title,route:{name:"JobDetail",params:{job:(L=e(t).data)==null?void 0:L.name}}}]},null,8,["items"]),(T=e(d).data)!=null&&T.name&&!e(M)?(u(),g("div",xe,[h.value&&e(p).data>0?(u(),f(w,{key:0,to:{name:"JobApplications",params:{job:(P=e(t).data)==null?void 0:P.name}}},{default:o(()=>[l(e(v),{variant:"subtle"},{default:o(()=>[m(n(s.__("View Applications")),1)]),_:1})]),_:1},8,["to"])):y("",!0),h.value?(u(),f(w,{key:1,to:{name:"JobForm",params:{jobName:(B=e(t).data)==null?void 0:B.name}}},{default:o(()=>[l(e(v),null,{prefix:o(()=>[l(e(Q),{class:"h-4 w-4 stroke-1.5"})]),default:o(()=>[m(" "+n(s.__("Edit")),1)]),_:1})]),_:1},8,["to"])):y("",!0),l(e(v),{onClick:a[0]||(a[0]=b=>{var j;return A((j=e(t).data)==null?void 0:j.company_website)})},{prefix:o(()=>[l(e(X),{class:"h-4 w-4 stroke-1.5"})]),default:o(()=>[m(" "+n(s.__("Visit Website")),1)]),_:1}),(D=e(_).data)!=null&&D.length?(u(),f(e($),{key:3,variant:"subtle",theme:"green",size:"lg"},{prefix:o(()=>[l(e(ee),{class:"h-4 w-4"})]),default:o(()=>[m(" "+n(s.__("You have applied")),1)]),_:1})):(u(),f(e(v),{key:2,variant:"solid",onClick:a[1]||(a[1]=b=>c())},{prefix:o(()=>[l(e(Z),{class:"h-4 w-4"})]),default:o(()=>[m(" "+n(s.__("Apply")),1)]),_:1}))])):e(M)?y("",!0):(u(),g("div",he,[l(e(v),{onClick:a[2]||(a[2]=b=>{var j;return r((j=e(t).data)==null?void 0:j.name)})},{default:o(()=>[i("span",null,n(s.__("Login to apply")),1)]),_:1})]))]),e(t).data?(u(),g("div",we,[i("div",je,[i("div",$e,[i("div",ze,[i("img",{src:e(t).data.company_logo,class:"size-10 rounded-lg object-contain cursor-pointer mr-4",alt:e(t).data.company_name,onClick:a[3]||(a[3]=b=>A(e(t).data.company_website))},null,8,Me),i("div",Se,[i("div",Ae,n(e(t).data.job_title),1),i("div",Ce,n(e(t).data.company_name)+" - "+n(e(t).data.location)+", "+n(e(t).data.country),1)])]),i("div",Ve,[l(e($),{size:"lg"},{prefix:o(()=>[l(e(ae),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:o(()=>[m(" "+n(e(z)(e(t).data.creation).fromNow()),1)]),_:1}),l(e($),{size:"lg"},{prefix:o(()=>[l(e(te),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:o(()=>[m(" "+n(e(t).data.type),1)]),_:1}),(F=e(t).data)!=null&&F.work_mode?(u(),f(e($),{key:0,size:"lg"},{prefix:o(()=>[l(e(se),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:o(()=>[m(" "+n(e(t).data.work_mode),1)]),_:1})):y("",!0),e(p).data?(u(),f(e($),{key:1,size:"lg"},{prefix:o(()=>[l(e(oe),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:o(()=>[m(" "+n(e(p).data)+" "+n(e(p).data==1?s.__("applicant"):s.__("applicants")),1)]),_:1})):y("",!0)])]),i("div",Je,[a[6]||(a[6]=i("div",{class:"bg-surface-gray-2 h-px m-1 w-1/2"},null,-1)),i("div",null,[l(e(q),{class:"size-3 stroke-1 text-ink-gray-5"})]),a[7]||(a[7]=i("div",{class:"bg-surface-gray-2 h-px m-1 w-1/2"},null,-1))]),i("p",{innerHTML:e(t).data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-12"},null,8,Ue)]),l(ve,{modelValue:x.value,"onUpdate:modelValue":a[4]||(a[4]=b=>x.value=b),application:e(_),"onUpdate:application":a[5]||(a[5]=b=>ie(_)?_.value=b:null),job:e(t).data.name},null,8,["modelValue","application","job"])])):y("",!0)])}}};export{Pe as default};
//# sourceMappingURL=JobDetail-CR0tEr1h.js.map
