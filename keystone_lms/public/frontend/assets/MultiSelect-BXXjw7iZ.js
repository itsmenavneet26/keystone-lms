import{s as D,cP as E,L as R,cQ as L,c as U,o as u,a as o,n as V,k as A,t as m,f as y,e as c,w as b,b as d,u as n,cR as I,cS as Q,ca as X,cT as G,F,r as M,l as H,cU as J,p as K,P as W,cb as Y,cV as Z,aq as ee,v as N,B as p,E as O}from"./index-H4DTv6Le.js";const te={key:0,class:"text-ink-red-3"},le={class:"relative w-full"},ae={class:"flex flex-col gap-1 p-1"},se={class:"text-base font-medium text-ink-gray-8"},re={class:"text-sm text-ink-gray-5"},ue={key:1,class:"text-ink-gray-7 px-4 py-2"},ne={key:0,class:"p-1 bg-surface-white border-t rounded-b-lg"},oe={key:1,class:"grid grid-cols-2 gap-2 mt-1"},ce={__name:"MultiSelect",props:N({label:String,size:{type:String,default:"sm"},doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},validate:Function,errorMessage:{type:Function,default:i=>`${i} is an Invalid value`},required:Boolean},{modelValue:{},modelModifiers:{}}),emits:N(["update:modelValue"],["update:modelValue"]),setup(i,{emit:q}){const f=i,a=D(i,"modelValue"),_=E(),w=p(null),x=p(""),k=p(""),v=p(null),C=p(null),S=q;R(v,e=>{e!=null&&e.value&&(x.value="",$(e.value),v.value=null,S("update:modelValue",a.value))}),L(x,e=>{e=e||"",k.value!==e&&(k.value=e,B(e))},{debounce:300,immediate:!0});const g=U({url:"frappe.desk.search.search_link",method:"POST",auto:!0,params:{txt:k.value,doctype:f.doctype}}),h=O(()=>(g.data||[]).filter(t=>{var l;return!((l=a.value)!=null&&l.includes(t.value))}));function B(e){g.update({params:{txt:e,doctype:f.doctype}}),g.reload()}function z(){var e,t;(e=g.data)!=null&&e.length||B(""),(t=w.value)==null||t.$el.click()}function $(e){if(C.value=null,!e)return;e.split(",").forEach(l=>{var r;if(l=l.trim(),!!l&&!((r=a.value)!=null&&r.includes(l))){if(f.validate&&!f.validate(l)){C.value=f.errorMessage(l);return}a.value?a.value.push(l):a.value=[l]}})}function P(e){let t=a.value.indexOf(e);t>-1&&a.value.splice(t,1),S("update:modelValue",a.value)}const T=O(()=>[{sm:"text-xs",md:"text-base"}[f.size||"sm"],"text-ink-gray-5"]);return(e,t)=>{var l;return u(),o("div",null,[i.label?(u(),o("label",{key:0,class:V(["block mb-1",T.value])},[A(m(i.label)+" ",1),i.required?(u(),o("span",te,"*")):y("",!0)],2)):y("",!0),c(n(Z),{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=r=>v.value=r),nullable:""},{default:b(({open:r})=>[d("div",le,[c(n(I),{ref:"search",class:"form-input w-full focus-visible:!ring-0",type:"text",onChange:t[0]||(t[0]=s=>{x.value=s.target.value}),autocomplete:"off",onFocus:z},null,512),c(n(Q),{ref_key:"trigger",ref:w,class:"hidden"},null,512),X(c(n(G),{static:"",class:"absolute z-20 mt-1 w-full rounded-lg bg-surface-modal border-2 border-outline-gray-modals max-h-[13rem] flex flex-col"},{default:b(()=>[d("div",{class:V(["flex-1 my-1 overflow-y-auto px-1.5",h.value.length?"min-h-[6rem]":"min-h-[3.8rem]"])},[h.value.length?(u(!0),o(F,{key:0},M(h.value,s=>(u(),H(n(J),{key:s.value,value:s},{default:b(({active:j})=>[d("li",{class:V(["flex cursor-pointer items-center rounded px-2 py-1 text-base",{"bg-surface-gray-2":j}])},[d("div",ae,[d("div",se,m(s.value===s.label?s.description:s.label),1),d("div",re,m(s.value),1)])],2)]),_:2},1032,["value"]))),128)):(u(),o("div",ue,m(e.__("No results found")),1))],2),n(_).onCreate?(u(),o("div",ne,[c(n(K),{variant:"ghost",class:"w-full !justify-start",label:e.__("Create New"),onClick:t[1]||(t[1]=s=>n(_).onCreate())},{prefix:b(()=>[c(n(W),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["label"])])):y("",!0)]),_:1},512),[[Y,r]])])]),_:1},8,["modelValue"]),(l=a.value)!=null&&l.length?(u(),o("div",oe,[(u(!0),o(F,null,M(a.value,r=>(u(),o("div",{key:r,class:"flex items-center justify-between break-all bg-surface-gray-2 text-ink-gray-7 p-2 rounded-md"},[d("span",null,m(r),1),c(n(ee),{class:"size-4 stroke-1.5 cursor-pointer",onClick:s=>P(r)},null,8,["onClick"])]))),128))])):y("",!0)])}}};export{ce as _};
//# sourceMappingURL=MultiSelect-BXXjw7iZ.js.map
