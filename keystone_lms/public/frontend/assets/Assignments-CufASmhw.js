import{d as z,s as L,L as S,o as p,l as D,w as y,b as d,t as _,e as i,u as s,N as $,Q as E,k as C,S as H,p as I,f as h,D as O,v as Q,a7 as W,T as U,E as A,g as G,aw as J,av as K,x as X,y as Y,W as Z,z as ee,A as se,a as q,P as te,al as ne,a8 as ae,F as le,i as R,q as oe,aF as ie,B as x}from"./index-H4DTv6Le.js";import{_ as ue}from"./EmptyState.vue_vue_type_script_setup_true_lang-C4EPuQXe.js";import{_ as re}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";const me={class:"p-5 text-base"},de={class:"text-lg text-ink-gray-9 font-semibold mb-5"},ce={class:"space-y-4 max-h-[75vh] overflow-y-auto"},pe={class:"text-xs text-ink-gray-5 mb-2"},ge={class:"flex justify-end space-x-2 mt-5"},ve=z({__name:"AssignmentForm",props:Q({assignmentID:{type:String,default:"new"}},{modelValue:{},modelModifiers:{},assignments:{},assignmentsModifiers:{}}),emits:["update:modelValue","update:assignments"],setup(v){const g=L(v,"modelValue"),k=L(v,"assignments"),e=W({title:"",type:"",question:"",course:""}),o=v;S(()=>o.assignmentID,l=>{var n;l!=="new"&&((n=k.value)==null||n.data.forEach(c=>{c.name===l&&(e.title=c.title,e.type=c.type,e.question=c.question,e.course=c.course||"")}))},{flush:"post"}),S(g,l=>{l&&o.assignmentID==="new"&&(e.title="",e.type="",e.question="")});const f=()=>{e.title=J(e.title.trim()),e.question=K(e.question)},b=()=>{f(),o.assignmentID=="new"?w():M()},w=()=>{k.value.insert.submit({...e},{onSuccess(){g.value=!1,U.success(__("Assignment created successfully"))}})},M=()=>{k.value.setValue.submit({...e,name:o.assignmentID},{onSuccess(){g.value=!1,U.success(__("Assignment updated successfully"))}})},V=A(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return(l,n)=>{const c=G("router-link");return p(),D(s(O),{modelValue:g.value,"onUpdate:modelValue":n[4]||(n[4]=u=>g.value=u),options:{size:"lg"}},{body:y(()=>[d("div",me,[d("div",de,_(v.assignmentID==="new"?l.__("Create an Assignment"):l.__("Edit Assignment")),1),d("div",ce,[i(s($),{modelValue:e.title,"onUpdate:modelValue":n[0]||(n[0]=u=>e.title=u),label:l.__("Title"),required:!0},null,8,["modelValue","label"]),i(s($),{modelValue:e.type,"onUpdate:modelValue":n[1]||(n[1]=u=>e.type=u),type:"select",options:V.value,label:l.__("Submission Type"),required:!0},null,8,["modelValue","options","label"]),i(s(E),{modelValue:e.course,"onUpdate:modelValue":n[2]||(n[2]=u=>e.course=u),label:l.__("Course"),doctype:"LMS Course",placeholder:" "},null,8,["modelValue","label"]),d("div",null,[d("div",pe,[C(_(l.__("Question"))+" ",1),n[5]||(n[5]=d("span",{class:"text-ink-red-3"},"*",-1))]),i(s(H),{content:e.question,onChange:n[3]||(n[3]=u=>e.question=u),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x border-outline-gray-modals bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[18rem] overflow-y-auto"},null,8,["content"])])]),d("div",ge,[i(c,{to:{name:"AssignmentSubmissionList",query:{assignmentID:v.assignmentID}}},{default:y(()=>[v.assignmentID!=="new"?(p(),D(s(I),{key:0,variant:"subtle"},{default:y(()=>[C(_(l.__("Check Submissions")),1)]),_:1})):h("",!0)]),_:1},8,["to"]),i(s(I),{variant:"solid",onClick:b},{default:y(()=>[C(_(l.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"])}}}),fe={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ye={class:"md:w-3/4 md:mx-auto py-5 mx-5"},_e={class:"flex items-center justify-between mb-5"},be={key:0,class:"text-lg font-semibold text-ink-gray-9"},we={key:1,class:"grid grid-cols-2 gap-5"},Ve={key:2,class:"flex justify-center my-5"},Ae={__name:"Assignments",setup(v){const g=R("$user"),k=R("$dayjs"),e=x(""),o=x(""),f=x(!1),b=x("new"),w=x(0),{brand:M}=X(),V=oe(),l=ie(),n=window.read_only_mode;Y(()=>{var a,t;!((a=g.data)!=null&&a.is_moderator)&&!((t=g.data)!=null&&t.is_instructor)&&V.push({name:"Courses"}),l.query.new==="true"&&(b.value="new",f.value=!0),N(),e.value=V.currentRoute.value.query.title,o.value=V.currentRoute.value.query.type}),S([e,o],()=>{V.push({query:{title:e.value,type:o.value}}),c()});const c=()=>{r.update({filters:u.value}),r.reload()},u=A(()=>{let a={};return e.value&&(a.title=["like",`%${e.value}%`]),o.value&&(a.type=o.value),a}),r=Z({doctype:"LMS Assignment",fields:["name","title","type","creation","question","course"],orderBy:"modified desc",cache:["assignments"],transform(a){return a.map(t=>({...t,creation:k(t.creation).fromNow()}))}}),j=A(()=>[{label:__("Title"),key:"title",width:2},{label:__("Type"),key:"type",width:1,align:"left"},{label:__("Created"),key:"creation",width:1,align:"right"}]),N=()=>{ee("frappe.client.get_count",{doctype:"LMS Assignment"}).then(a=>{w.value=a})},P=A(()=>["","Document","Image","PDF","URL","Text"].map(t=>({label:__(t),value:t}))),B=A(()=>[{label:__("Assignments"),route:{name:"Assignments"}}]);return se(()=>({title:__("Assignments"),icon:M.favicon})),(a,t)=>{var T,F;return p(),q(le,null,[d("header",fe,[i(s(re),{items:B.value},null,8,["items"]),s(n)?h("",!0):(p(),D(s(I),{key:0,variant:"solid",onClick:t[0]||(t[0]=()=>{b.value="new",f.value=!0})},{prefix:y(()=>[i(s(te),{class:"w-4 h-4"})]),default:y(()=>[C(" "+_(a.__("Create")),1)]),_:1}))]),d("div",ye,[d("div",_e,[w.value?(p(),q("div",be,_(a.__("{0} Assignments").format(w.value)),1)):h("",!0),(T=s(r).data)!=null&&T.length||w.value>0?(p(),q("div",we,[i(s($),{modelValue:e.value,"onUpdate:modelValue":t[1]||(t[1]=m=>e.value=m),placeholder:a.__("Search by title")},null,8,["modelValue","placeholder"]),i(s($),{modelValue:o.value,"onUpdate:modelValue":t[2]||(t[2]=m=>o.value=m),type:"select",options:P.value,placeholder:a.__("Type")},null,8,["modelValue","options","placeholder"])])):h("",!0)]),(F=s(r).data)!=null&&F.length?(p(),D(s(ne),{key:0,columns:j.value,rows:s(r).data,"row-key":"name",options:{showTooltip:!1,selectable:!1,onRowClick:m=>{s(n)||(b.value=m.name,f.value=!0)}}},null,8,["columns","rows","options"])):(p(),D(ue,{key:1,type:"Assignments"})),s(r).data&&s(r).hasNextPage?(p(),q("div",Ve,[i(s(I),{onClick:t[3]||(t[3]=m=>s(r).next())},{default:y(()=>[C(_(a.__("Load More")),1)]),_:1})])):h("",!0)]),i(ve,{modelValue:f.value,"onUpdate:modelValue":t[4]||(t[4]=m=>f.value=m),assignments:s(r),"onUpdate:assignments":t[5]||(t[5]=m=>ae(r)?r.value=m:null),assignmentID:b.value},null,8,["modelValue","assignments","assignmentID"])],64)}}};export{Ae as default};
//# sourceMappingURL=Assignments-CufASmhw.js.map
