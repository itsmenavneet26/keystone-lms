{"version":3,"file":"AxisChart.vue_vue_type_script_setup_true_lang-CnJJCsjX.js","sources":["../../../../frontend/node_modules/frappe-ui/src/components/Charts/axisChartOptions.ts","../../../../frontend/node_modules/frappe-ui/src/components/Charts/AxisChart.vue"],"sourcesContent":["import useEchartsOptions from './eChartOptions'\nimport { formatValue, mergeDeep } from './helpers'\nimport {\n  AreaSeriesConfig,\n  AxisChartConfig,\n  BarSeriesConfig,\n  LineSeriesConfig,\n} from './types'\n\nexport default function useAxisChartOptions(config: AxisChartConfig) {\n  const data = config.data || []\n  const baseOptions = useEchartsOptions(config)\n\n  if (config.xAxis.type === 'time' && config.swapXY) {\n    throw new Error('Swap axes is not supported for time series data')\n  }\n\n  if (\n    config.series.find((s) => s.axis === 'y2' || s.type !== 'bar') &&\n    config.swapXY\n  ) {\n    throw new Error('Swap axes is not supported for non-bar series or y2 axis')\n  }\n\n  const swapXY = config.swapXY\n  const lastBarSeriesIdx = config.series\n    .slice()\n    .reverse()\n    .findIndex((s) => s.type === 'bar')\n  const hasY2 = config.series.some((s) => s.axis === 'y2')\n\n  if (hasY2) {\n    baseOptions.yAxis[1].show = true\n  }\n\n  baseOptions.series = config.series.map((s, idx) => {\n    let labelPosition = 'top'\n    if (s.type == 'bar' && config.stacked) {\n      labelPosition = idx == lastBarSeriesIdx ? 'top' : 'inside'\n    }\n    if (s.type == 'bar' && swapXY) {\n      labelPosition = 'right'\n    }\n\n    const standardSeriesOptions = {\n      type: s.type,\n      name: s.name,\n      data: data.map((row: any) => {\n        let x, y\n        if (swapXY) {\n          x = row[s.name]\n          y = row[config.xAxis.key]\n        } else {\n          x = row[config.xAxis.key]\n          y = row[s.name]\n        }\n        return [x, y]\n      }),\n      yAxisIndex: s.axis === 'y2' ? 1 : 0,\n      label: {\n        show: s.showDataLabels,\n        position: labelPosition,\n        formatter: (params: any) => {\n          const _val = swapXY ? params.value?.[0] : params.value?.[1]\n          return formatValue(_val, 1, true)\n        },\n        fontSize: 11,\n      },\n      labelLayout: { hideOverlap: true },\n      itemStyle: {\n        color: s.color,\n      },\n    }\n\n    let seriesTypeOptions = {}\n    if (s.type === 'bar') {\n      seriesTypeOptions = getBarSeriesOptions(config, s)\n    }\n    if (s.type === 'line') {\n      seriesTypeOptions = getLineSeriesOptions(config, s)\n    }\n    if (s.type === 'area') {\n      seriesTypeOptions = getAreaSeriesOptions(config, s)\n    }\n\n    return mergeDeep(standardSeriesOptions, seriesTypeOptions, s.echartOptions)\n  })\n\n  return mergeDeep(baseOptions, config.echartOptions)\n}\n\nfunction getBarSeriesOptions(config: AxisChartConfig, series: BarSeriesConfig) {\n  const roundedCorners = config.swapXY ? [0, 2, 2, 0] : [2, 2, 0, 0]\n  const idx = config.series.findIndex((s) => s.name === series.name)\n  const lastBarSeriesIdx = config.series\n    .slice()\n    .reverse()\n    .findIndex((s) => s.type === 'bar')\n\n  const isLastBar = lastBarSeriesIdx === idx\n\n  return {\n    stack: config.stacked ? 'stack' : undefined,\n    barMaxWidth: 60,\n    itemStyle: {\n      borderRadius: config.stacked\n        ? isLastBar\n          ? roundedCorners\n          : 0\n        : roundedCorners,\n    },\n  }\n}\n\nfunction getLineSeriesOptions(\n  config: AxisChartConfig,\n  series: LineSeriesConfig,\n) {\n  const showSymbol = series.showDataPoints || series.showDataLabels\n  return {\n    connectNulls: true,\n    symbol: 'circle',\n    symbolSize: 7,\n    showSymbol: showSymbol,\n    emphasis: {},\n    lineStyle: {\n      width: series.lineWidth || 2,\n      type: series.lineType,\n    },\n  }\n}\n\nfunction getAreaSeriesOptions(\n  config: AxisChartConfig,\n  series: AreaSeriesConfig,\n) {\n  return {\n    type: 'line',\n    showSymbol: series.showDataPoints,\n    areaStyle: {\n      color: series.color,\n      opacity: series.fillOpacity || 0.5,\n    },\n  }\n}\n","<template>\n  <ECharts :options=\"options\" :error=\"error\" />\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ref } from 'vue'\nimport useAxisChartOptions from './axisChartOptions'\nimport ECharts from './ECharts.vue'\nimport { AxisChartConfig } from './types'\n\nconst props = defineProps<{ config: AxisChartConfig }>()\n\nconst error = ref('')\nconst options = computed(() => {\n  try {\n    return useAxisChartOptions(props.config)\n  } catch (e: any) {\n    error.value = e.message\n    return {}\n  }\n})\n</script>\n"],"names":["useAxisChartOptions","config","data","baseOptions","useEchartsOptions","s","swapXY","lastBarSeriesIdx","idx","labelPosition","standardSeriesOptions","row","x","y","params","_val","_a","_b","formatValue","seriesTypeOptions","getBarSeriesOptions","getLineSeriesOptions","getAreaSeriesOptions","mergeDeep","series","roundedCorners","isLastBar","props","__props","error","ref","options","computed","e","_createBlock","ECharts"],"mappings":"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","x_google_ignoreList":[0,1]}