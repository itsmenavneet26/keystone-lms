{"version":3,"file":"CertifiedParticipants-DwPXaatj.js","sources":["../../../../frontend/src/pages/CertifiedParticipants.vue"],"sourcesContent":["<template>\n\t<header\n\t\tclass=\"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5\"\n\t>\n\t\t<Breadcrumbs :items=\"breadcrumbs\" />\n\t\t<router-link :to=\"{ name: 'Courses', query: { certification: true } }\">\n\t\t\t<Button>\n\t\t\t\t<template #prefix>\n\t\t\t\t\t<GraduationCap class=\"h-4 w-4 stroke-1.5\" />\n\t\t\t\t</template>\n\t\t\t\t{{ __('Get Certified') }}\n\t\t\t</Button>\n\t\t</router-link>\n\t</header>\n\t<div class=\"mx-auto w-full max-w-4xl pt-6 pb-10\">\n\t\t<div class=\"flex flex-col md:flex-row justify-between mb-8 px-3\">\n\t\t\t<div class=\"text-xl font-semibold text-ink-gray-9 mb-4 md:mb-0\">\n\t\t\t\t{{ memberCount }} {{ __('Certified Members') }}\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-4\"\n\t\t\t>\n\t\t\t\t<div class=\"flex items-center space-x-4\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"nameFilter\"\n\t\t\t\t\t\t:placeholder=\"__('Search by Name')\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\tclass=\"min-w-40 lg:min-w-0 lg:w-32 xl:w-40\"\n\t\t\t\t\t\t@input=\"updateParticipants()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"categories.data?.length\"\n\t\t\t\t\t\tclass=\"min-w-40 lg:min-w-0 lg:w-32 xl:w-40\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Select\n\t\t\t\t\t\t\tv-model=\"currentCategory\"\n\t\t\t\t\t\t\t:options=\"categories.data\"\n\t\t\t\t\t\t\t:placeholder=\"__('Category')\"\n\t\t\t\t\t\t\t@update:modelValue=\"updateParticipants()\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex items-center space-x-4\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"openToWork\"\n\t\t\t\t\t\t:label=\"__('Open to Work')\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t@change=\"updateParticipants()\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tv-model=\"hiring\"\n\t\t\t\t\t\t:label=\"__('Hiring')\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t@change=\"updateParticipants()\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"participants.data?.length\" class=\"\">\n\t\t\t<template v-for=\"(participant, index) in participants.data\">\n\t\t\t\t<router-link\n\t\t\t\t\t:to=\"{\n\t\t\t\t\t\tname: 'ProfileAbout',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tusername: participant.username,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"rounded-md hover:bg-surface-gray-2 px-3\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"flex items-center w-full space-x-3 py-2\"\n\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t'border-b': index < participants.data.length - 1,\n\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<UserAvatar :user=\"participant\" size=\"2xl\" />\n\n\t\t\t\t\t\t\t<div class=\"flex flex-col md:flex-row w-full\">\n\t\t\t\t\t\t\t\t<div class=\"flex-1\">\n\t\t\t\t\t\t\t\t\t<div class=\"text-base font-medium text-ink-gray-8\">\n\t\t\t\t\t\t\t\t\t\t{{ participant.full_name }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tv-if=\"participant.headline\"\n\t\t\t\t\t\t\t\t\t\tclass=\"mt-1.5 text-base text-ink-gray-5\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{ participant.headline }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclass=\"flex items-center space-x-3 md:space-x-24 text-sm md:text-base mt-1.5\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t\t{{ participant.certificate_count }}\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\tparticipant.certificate_count > 1\n\t\t\t\t\t\t\t\t\t\t\t\t? __('certificates')\n\t\t\t\t\t\t\t\t\t\t\t\t: __('certificate')\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span class=\"text-ink-gray-4 md:hidden\">Â·</span>\n\t\t\t\t\t\t\t\t\t<div class=\"text-ink-gray-5\">\n\t\t\t\t\t\t\t\t\t\t{{ dayjs(participant.issue_date).format('DD MMM YYYY') }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</router-link>\n\t\t\t</template>\n\t\t</div>\n\t\t<EmptyState v-else type=\"Certified Members\" />\n\t\t<div\n\t\t\tv-if=\"!participants.list.loading && participants.hasNextPage\"\n\t\t\tclass=\"flex justify-center mt-5\"\n\t\t>\n\t\t\t<Button @click=\"participants.next()\">\n\t\t\t\t{{ __('Load More') }}\n\t\t\t</Button>\n\t\t</div>\n\t</div>\n</template>\n<script setup>\nimport {\n\tAvatar,\n\tBreadcrumbs,\n\tButton,\n\tcall,\n\tcreateListResource,\n\tFormControl,\n\tSelect,\n\tusePageMeta,\n} from 'frappe-ui'\nimport { computed, inject, onMounted, ref } from 'vue'\nimport { GraduationCap } from 'lucide-vue-next'\nimport { sessionStore } from '../stores/session'\nimport { useRouter } from 'vue-router'\nimport EmptyState from '@/components/EmptyState.vue'\nimport UserAvatar from '@/components/UserAvatar.vue'\n\nconst filters = ref({})\nconst currentCategory = ref('')\nconst nameFilter = ref('')\nconst openToWork = ref(false)\nconst hiring = ref(false)\nconst { brand } = sessionStore()\nconst memberCount = ref(0)\nconst dayjs = inject('$dayjs')\nconst user = inject('$user')\nconst router = useRouter()\n\nonMounted(() => {\n\tif (!user.data) {\n\t\trouter.push({ name: 'Courses' })\n\t\treturn\n\t}\n\tsetFiltersFromQuery()\n\tupdateParticipants()\n})\n\nconst participants = createListResource({\n\tdoctype: 'LMS Certificate',\n\turl: 'lms.lms.api.get_certified_participants',\n\tstart: 0,\n\tcache: ['certified_participants'],\n\tpageLength: 100,\n})\n\nconst getMemberCount = () => {\n\tcall('lms.lms.api.get_count_of_certified_members', {\n\t\tfilters: filters.value,\n\t}).then((data) => {\n\t\tmemberCount.value = data\n\t})\n}\n\nconst categories = createListResource({\n\tdoctype: 'LMS Certificate',\n\turl: 'lms.lms.api.get_certification_categories',\n\tcache: ['certification_categories'],\n\tauto: user.data ? true : false,\n\ttransform(data) {\n\t\tdata.unshift({ label: __(' '), value: ' ' })\n\t\treturn data\n\t},\n})\n\nconst updateParticipants = () => {\n\tupdateFilters()\n\tgetMemberCount()\n\tsetQueryParams()\n\n\tparticipants.update({\n\t\tfilters: filters.value,\n\t})\n\tparticipants.reload()\n}\n\nconst updateFilters = () => {\n\tfilters.value = {\n\t\t...(currentCategory.value.trim('') && {\n\t\t\tcategory: currentCategory.value,\n\t\t}),\n\t\t...(nameFilter.value && {\n\t\t\tmember_name: ['like', `%${nameFilter.value}%`],\n\t\t}),\n\t\t...(openToWork.value && {\n\t\t\topen_to_work: true,\n\t\t}),\n\t\t...(hiring.value && {\n\t\t\thiring: true,\n\t\t}),\n\t}\n}\n\nconst setQueryParams = () => {\n\tlet queries = new URLSearchParams(location.search)\n\tlet filterKeys = {\n\t\tcategory: currentCategory.value,\n\t\tname: nameFilter.value,\n\t\t'open-to-work': openToWork.value,\n\t\thiring: hiring.value,\n\t}\n\n\tObject.keys(filterKeys).forEach((key) => {\n\t\tif (filterKeys[key] && hasValue(filterKeys[key])) {\n\t\t\tqueries.set(key, filterKeys[key])\n\t\t} else {\n\t\t\tqueries.delete(key)\n\t\t}\n\t})\n\thistory.replaceState(\n\t\t{},\n\t\t'',\n\t\t`${location.pathname}${queries.size > 0 ? `?${queries.toString()}` : ''}`\n\t)\n}\n\nconst hasValue = (value) => {\n\tif (typeof value === 'string') {\n\t\treturn value.trim() !== ''\n\t}\n\treturn true\n}\n\nconst setFiltersFromQuery = () => {\n\tlet queries = new URLSearchParams(location.search)\n\tnameFilter.value = queries.get('name') || ''\n\tcurrentCategory.value = queries.get('category') || ''\n\topenToWork.value = queries.get('open-to-opportunities') === 'true'\n\thiring.value = queries.get('hiring') === 'true'\n}\n\nconst breadcrumbs = computed(() => [\n\t{\n\t\tlabel: __('Certified Members'),\n\t\troute: { name: 'CertifiedParticipants' },\n\t},\n])\n\nusePageMeta(() => {\n\treturn {\n\t\ttitle: __('Certified Members'),\n\t\ticon: brand.favicon,\n\t}\n})\n</script>\n<style>\n.headline {\n\tdisplay: -webkit-box;\n\t-webkit-line-clamp: 1;\n\t-webkit-box-orient: vertical;\n\ttext-overflow: ellipsis;\n\twidth: 100%;\n\toverflow: hidden;\n}\n</style>\n"],"names":["filters","ref","currentCategory","nameFilter","openToWork","hiring","brand","sessionStore","memberCount","dayjs","inject","user","router","useRouter","onMounted","setFiltersFromQuery","updateParticipants","participants","createListResource","getMemberCount","call","data","categories","updateFilters","setQueryParams","queries","filterKeys","key","hasValue","value","breadcrumbs","computed","usePageMeta","_createElementVNode","_hoisted_1","_createVNode","_unref","Breadcrumbs","_component_router_link","Button","GraduationCap","_createTextVNode","__","_hoisted_2","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","_hoisted_6","FormControl","$event","_openBlock","_createElementBlock","_hoisted_7","Select","_hoisted_8","_hoisted_9","_Fragment","participant","index","_createBlock","_hoisted_10","UserAvatar","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_cache","_hoisted_17","EmptyState","_hoisted_18"],"mappings":"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"}