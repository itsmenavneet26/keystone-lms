import{o as c,a as _,b as a,k as P,t as i,e as r,w,u as n,p as C,x as G,H as O,y as W,c as S,B as N,a7 as H,T as $,E as R,L as J,A as F,f as p,at as X,N as m,l as x,aq as Y,a9 as A,aW as f,i as Q}from"./index-H4DTv6Le.js";import{_ as Z}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-CKfttt8M.js";const ee={class:"text-base border rounded-md w-1/3 mx-auto my-32"},te={class:"border-b px-5 py-3 font-medium text-ink-gray-9"},se={class:"px-5 py-3"},ne={class:"mb-4 leading-6 text-ink-gray-7"},M={__name:"NotPermitted",props:{title:{type:String,default:"Not Permitted"},text:{type:String,default:"You are not permitted to access this page."},buttonLabel:{type:String,default:"Login"},buttonLink:{type:String,default:"/login"}},setup(d){const v=d,L=()=>{window.location.href=v.buttonLink};return(y,g)=>(c(),_("div",ee,[a("div",te,[g[1]||(g[1]=a("span",{class:"inline-flex items-center before:bg-surface-red-5 before:w-2 before:h-2 before:rounded-md before:mr-2"},null,-1)),P(" "+i(y.__(d.title)),1)]),a("div",se,[a("div",ne,i(y.__(d.text)),1),r(n(C),{variant:"solid",class:"w-full",onClick:g[0]||(g[0]=u=>L())},{default:w(()=>[P(i(y.__(d.buttonLabel)),1)]),_:1})])]))}},ae={class:""},oe={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},le={key:0,class:"pt-5 pb-10 mx-5"},ie={class:"flex flex-col lg:flex-row justify-between"},re={class:"flex flex-col lg:order-last mb-10 lg:mt-10 lg:w-1/4"},ue={class:"h-fit bg-surface-gray-2 rounded-md p-5 space-y-4"},de={class:"space-y-1"},ce={class:"text-ink-gray-5 uppercase text-xs"},me={class:"leading-5 text-ink-gray-9"},pe={key:0,class:"space-y-1"},_e={class:"text-ink-gray-5 uppercase text-xs"},ye={class:"text-ink-gray-9"},be={key:1,class:"space-y-1"},ge={class:"text-ink-gray-5"},fe={key:2,class:"space-y-1"},he={class:"text-ink-gray-5 uppercase text-xs"},ve={class:"text-ink-gray-9"},ke={class:"space-y-1 border-t border-outline-gray-3 pt-4 mt-2"},Ve={class:"uppercase text-ink-gray-5 text-xs"},xe={class:"font-bold text-ink-gray-9"},we={class:"bg-surface-gray-2 rounded-md p-4 space-y-2 my-5"},Ce={class:"text-ink-gray-5 uppercase text-xs"},Pe={class:"flex items-center space-x-2"},Le={class:"bg-surface-amber-2 text-ink-amber-2 text-sm leading-5 p-2 rounded-md"},Se={class:"flex-1 lg:mr-10"},$e={class:"mb-5"},Be={class:"text-lg font-semibold text-ink-gray-9"},Ue={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},Ne={class:"space-y-4"},Ae={class:"space-y-4"},Me={class:"flex flex-col lg:flex-row items-start lg:items-center justify-between border-t pt-4 mt-8 space-y-4 lg:space-y-0"},qe={key:0,class:"mt-1 text-xs text-ink-red-3"},Te={key:1},je={key:2},Ee={__name:"Billing",props:{type:{type:String,required:!0},name:{type:String,required:!0}},setup(d){const v=Q("$user"),{brand:L}=G(),y=N(!1),{capture:g}=O();W(()=>{var s;const e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",document.body.appendChild(e),(s=v.data)!=null&&s.name&&k.submit()});const u=d,k=S({url:"lms.lms.api.validate_billing_access",params:{billing_type:u.type,name:u.name},onSuccess(e){q(e.address),l.submit()}}),l=S({url:"lms.lms.utils.get_order_summary",makeParams(e){return{doctype:u.type=="batch"?"LMS Batch":"LMS Course",docname:u.name,country:t.country,coupon:b.value}},onError(e){E(e)}}),b=N(null),t=H({}),q=e=>{t.billing_name=(e==null?void 0:e.billing_name)||"",t.address_line1=(e==null?void 0:e.address_line1)||"",t.address_line2=(e==null?void 0:e.address_line2)||"",t.city=(e==null?void 0:e.city)||"",t.state=(e==null?void 0:e.state)||"",t.country=(e==null?void 0:e.country)||"",t.pincode=(e==null?void 0:e.pincode)||"",t.phone=(e==null?void 0:e.phone)||"",t.source=(e==null?void 0:e.source)||"",t.gstin=(e==null?void 0:e.gstin)||"",t.pan=(e==null?void 0:e.pan)||""},T=S({url:"lms.lms.payments.get_payment_link",makeParams(e){return{doctype:u.type=="batch"?"LMS Batch":"LMS Course",docname:u.name,title:l.data.title,amount:l.data.original_amount,discount_amount:l.data.discount_amount||0,gst_amount:l.data.gst_applied||0,currency:l.data.currency,address:t,redirect_to:K.value,payment_for_certificate:u.type=="certificate",coupon_code:b.value,coupon:l.data.coupon}}}),j=()=>{T.submit({},{validate(){return t.source?t.member_consent?D():(y.value=!0,__("Please provide your consent to proceed with the payment.")):__("Please let us know where you heard about us from.")},onSuccess(e){g("checkout_initiated",{type:u.type}),window.location.href=e},onError(e){var s;$.error(((s=e.messages)==null?void 0:s[0])||e)}})};function B(){if(!b.value){$.error(__("Please enter a coupon code"));return}l.reload()}function z(){b.value=null,l.reload()}const D=()=>{let e=["billing_name","address_line1","city","pincode","country","phone","source"];for(let h of e)if(!t[h])return"Please enter a valid "+h.replaceAll("_"," ").toLowerCase().replace(/\b\w/g,V=>V.toUpperCase());if(t.gstin&&!t.pan)return"Please enter a valid pan number.";if(t.country=="India"&&!t.state)return"Please enter a valid state with correct spelling and the first letter capitalized.";const s=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Delhi","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"];if(t.country=="India"&&!s.includes(t.state))return"Please enter a valid state with correct spelling and the first letter capitalized."},E=e=>{var s;$.error(((s=e.messages)==null?void 0:s[0])||e)},I=e=>{t.country=e,l.reload()},K=R(()=>{if(u.type=="course")return f(`courses/${u.name}`);if(u.type=="batch")return f(`batches/${u.name}`);if(u.type=="certificate")return f(`courses/${u.name}/certification`)});return J(t,()=>{t.member_consent&&(y.value=!1)}),F(()=>({title:__("Billing Details"),icon:L.favicon})),(e,s)=>{var h,V,U;return c(),_("div",ae,[a("header",oe,[r(n(Z),{class:"h-7",items:[{label:e.__("Billing Details"),route:{name:"Billing"}}]},null,8,["items"])]),(h=n(k).data)!=null&&h.access&&n(l).data?(c(),_("div",le,[a("div",ie,[a("div",re,[a("div",ue,[a("div",de,[a("div",ce,i(e.__("Payment for "))+" "+i(d.type)+": ",1),a("div",me,i(n(l).data.title),1)]),n(l).data.gst_applied||n(l).data.discount_amount?(c(),_("div",pe,[a("div",_e,i(e.__("Original Amount"))+": ",1),a("div",ye,i(n(l).data.original_amount_formatted),1)])):p("",!0),n(l).data.discount_amount?(c(),_("div",be,[a("div",ge,i(e.__("Discount"))+":",1),a("div",null,"- "+i(n(l).data.discount_amount_formatted),1)])):p("",!0),n(l).data.gst_applied?(c(),_("div",fe,[a("div",he,i(e.__("GST Amount"))+": ",1),a("div",ve,i(n(l).data.gst_amount_formatted),1)])):p("",!0),a("div",ke,[a("div",Ve,i(e.__("Total"))+": ",1),a("div",xe,i(n(l).data.total_amount_formatted),1)])]),a("div",we,[a("span",Ce,i(e.__("Enter a Coupon Code"))+": ",1),a("div",Pe,[r(n(m),{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=o=>b.value=o),disabled:n(l).data.discount_amount>0,onInput:s[1]||(s[1]=o=>b.value=o.target.value.toUpperCase()),onKeydown:X(B,["enter"]),placeholder:"COUPON2025",autocomplete:"off",class:"flex-1 [&_input]:bg-white"},null,8,["modelValue","disabled"]),n(l).data.discount_amount?p("",!0):(c(),x(n(C),{key:0,onClick:B,variant:"outline"},{default:w(()=>[P(i(e.__("Apply")),1)]),_:1})),n(l).data.discount_amount?(c(),x(n(C),{key:1,onClick:z,variant:"outline"},{icon:w(()=>[r(n(Y),{class:"size-4 stroke-1.5"})]),_:1})):p("",!0)])]),a("p",Le,i(e.__("Please ensure that the billing name you enter is correct, as it will be used on your invoice.")),1)]),a("div",Se,[a("div",$e,[a("div",Be,i(e.__("Address")),1)]),a("div",Ue,[a("div",Ne,[r(n(m),{label:e.__("Billing Name"),modelValue:t.billing_name,"onUpdate:modelValue":s[2]||(s[2]=o=>t.billing_name=o),required:!0},null,8,["label","modelValue"]),r(n(m),{label:e.__("Address Line 1"),modelValue:t.address_line1,"onUpdate:modelValue":s[3]||(s[3]=o=>t.address_line1=o),required:!0},null,8,["label","modelValue"]),r(n(m),{label:e.__("Address Line 2"),modelValue:t.address_line2,"onUpdate:modelValue":s[4]||(s[4]=o=>t.address_line2=o)},null,8,["label","modelValue"]),r(n(m),{label:e.__("City"),modelValue:t.city,"onUpdate:modelValue":s[5]||(s[5]=o=>t.city=o),required:!0},null,8,["label","modelValue"]),r(n(m),{label:e.__("State/Province"),modelValue:t.state,"onUpdate:modelValue":s[6]||(s[6]=o=>t.state=o)},null,8,["label","modelValue"])]),a("div",Ae,[r(A,{doctype:"Country",value:t.country,onChange:s[7]||(s[7]=o=>I(o)),label:e.__("Country"),required:!0},null,8,["value","label"]),r(n(m),{label:e.__("Postal Code"),modelValue:t.pincode,"onUpdate:modelValue":s[8]||(s[8]=o=>t.pincode=o),required:!0},null,8,["label","modelValue"]),r(n(m),{label:e.__("Phone Number"),modelValue:t.phone,"onUpdate:modelValue":s[9]||(s[9]=o=>t.phone=o),required:!0},null,8,["label","modelValue"]),r(A,{doctype:"LMS Source",value:t.source,onChange:s[10]||(s[10]=o=>t.source=o),label:e.__("Where did you hear about us?"),required:!0},null,8,["value","label"]),t.country=="India"?(c(),x(n(m),{key:0,label:e.__("GST Number"),modelValue:t.gstin,"onUpdate:modelValue":s[11]||(s[11]=o=>t.gstin=o)},null,8,["label","modelValue"])):p("",!0),t.country=="India"?(c(),x(n(m),{key:1,label:e.__("PAN Number"),modelValue:t.pan,"onUpdate:modelValue":s[12]||(s[12]=o=>t.pan=o)},null,8,["label","modelValue"])):p("",!0)])]),a("div",Me,[a("div",null,[r(n(m),{label:e.__("I consent to my personal information being stored for invoicing"),type:"checkbox",class:"leading-6",modelValue:t.member_consent,"onUpdate:modelValue":s[13]||(s[13]=o=>t.member_consent=o)},null,8,["label","modelValue"]),y.value?(c(),_("div",qe,i(e.__("Please provide your consent to proceed with the payment")),1)):p("",!0)]),r(n(C),{variant:"solid",size:"md",onClick:s[14]||(s[14]=o=>j())},{default:w(()=>[P(i(e.__("Proceed to Payment")),1)]),_:1})])])])])):(V=n(k).data)!=null&&V.message?(c(),_("div",Te,[r(M,{text:n(k).data.message,buttonLabel:d.type=="course"?"Checkout Course":"Checkout Batch",buttonLink:d.type=="course"?n(f)(`courses/${d.name}`):n(f)(`batches/${d.name}`)},null,8,["text","buttonLabel","buttonLink"])])):(U=n(v).data)!=null&&U.name?p("",!0):(c(),_("div",je,[r(M,{text:"Please login to access this page.",buttonLink:`/login?redirect-to=${n(f)(`billing/${d.type}/${d.name}`)}`},null,8,["buttonLink"])]))])}}};export{Ee as default};
//# sourceMappingURL=Billing-s6mTbiNe.js.map
